"use strict";define("OfficeFabric/components/List/List.types",["require","exports"],function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.auto=0]="auto",e[e.top=1]="top",e[e.bottom=2]="bottom",e[e.center=3]="center"}(t.ScrollToMode||(t.ScrollToMode={}))}),define("OfficeFabric/components/List/List",["require","exports","tslib","react","../../Utilities"],function(e,t,i,s,o){Object.defineProperty(t,"__esModule",{value:!0});var r=16,n=100,a=500,h=200,d=500,l={top:-1,bottom:-1,left:-1,right:-1,width:0,height:0},c=function(e){return e.getBoundingClientRect()},p=c,g=c,u=function(e){function t(t){var l=e.call(this,t)||this;return l._root=o.createRef(),l._surface=o.createRef(),l._onRenderPage=function(e,t){var r=l.props,n=r.onRenderCell,a=r.role,h=e.page,d=h.items,c=h.startIndex,p=i.__rest(e,["page"]),g=void 0===a?"listitem":"presentation",u=(d||[]).map(function(e,t){var i=c+t,r=l.props.getKey?l.props.getKey(e,i):e&&e.key;return null==r&&(r=i),s.createElement("div",{role:g,className:o.css("ms-List-cell"),key:r,"data-list-index":i,"data-automationid":"ListCell"},n&&n(e,i,l.state.isScrolling))});return s.createElement("div",i.__assign({},p),u)},l.state={pages:[],isScrolling:!1},l._estimatedPageHeight=0,l._totalEstimates=0,l._requiredWindowsAhead=0,l._requiredWindowsBehind=0,l._measureVersion=0,l._onAsyncScroll=l._async.debounce(l._onAsyncScroll,n,{leading:!1,maxWait:a}),l._onAsyncIdle=l._async.debounce(l._onAsyncIdle,h,{leading:!1}),l._onAsyncResize=l._async.debounce(l._onAsyncResize,r,{leading:!1}),l._onScrollingDone=l._async.debounce(l._onScrollingDone,d,{leading:!1}),l._cachedPageHeights={},l._estimatedPageHeight=0,l._focusedIndex=-1,l._pageCache={},l}return i.__extends(t,e),t.prototype.scrollToIndex=function(e,t,i){void 0===i&&(i=0);for(var s=this.props.startIndex,o=s+this._getRenderCount(),r=this._allowedRect,n=0,a=1,h=s;h<o;h+=a){var d=this._getPageSpecification(h,r),l=d.height;if(a=d.itemCount,h<=e&&h+a>e){if(t){for(var c=g(this._scrollElement),p={top:this._scrollElement.scrollTop,bottom:this._scrollElement.scrollTop+c.height},u=e-h,_=0;_<u;++_)n+=t(h+_);var f=n+t(e);switch(i){case 1:return void(this._scrollElement.scrollTop=n);case 2:return void(this._scrollElement.scrollTop=f-c.height);case 3:return void(this._scrollElement.scrollTop=(n+f-c.height)/2)}if(n>=p.top&&f<=p.bottom)return;n<p.top||f>p.bottom&&(n=f-c.height)}return void(this._scrollElement.scrollTop=n)}n+=l}},t.prototype.componentDidMount=function(){this._updatePages(),this._measureVersion++,this._scrollElement=o.findScrollableParent(this._root.current),this._events.on(window,"resize",this._onAsyncResize),this._root.current&&this._events.on(this._root.current,"focus",this._onFocus,!0),this._scrollElement&&(this._events.on(this._scrollElement,"scroll",this._onScroll),this._events.on(this._scrollElement,"scroll",this._onAsyncScroll))},t.prototype.componentWillReceiveProps=function(e){e.items===this.props.items&&e.renderCount===this.props.renderCount&&e.startIndex===this.props.startIndex||(this._resetRequiredWindows(),this._requiredRect=null,this._measureVersion++,this._invalidatePageCache(),this._updatePages(e))},t.prototype.shouldComponentUpdate=function(e,t){var i=this.state.pages,s=t.pages,o=!1;if(!t.isScrolling&&this.state.isScrolling)return!0;if(e.items===this.props.items&&i.length===s.length)for(var r=0;r<i.length;r++){var n=i[r],a=s[r];if(n.key!==a.key||n.itemCount!==a.itemCount){o=!0;break}}else o=!0;return o},t.prototype.forceUpdate=function(){this._invalidatePageCache(),this._updateRenderRects(this.props,!0),this._updatePages(),this._measureVersion++,e.prototype.forceUpdate.call(this)},t.prototype.render=function(){for(var e=this.props,t=e.className,r=e.role,n=this.state.pages,a=void 0===n?[]:n,h=[],d=o.getNativeProps(this.props,o.divProperties),l=0,c=a;l<c.length;l++){var p=c[l];h.push(this._renderPage(p))}return s.createElement("div",i.__assign({ref:this._root},d,{role:void 0===r?"list":r,className:o.css("ms-List",t)}),s.createElement("div",{ref:this._surface,className:o.css("ms-List-surface"),role:"presentation"},h))},t.prototype._shouldVirtualize=function(e){void 0===e&&(e=this.props);var t=e.onShouldVirtualize;return!t||t(e)},t.prototype._invalidatePageCache=function(){this._pageCache={}},t.prototype._renderPage=function(e){var t,i=this.props.usePageCache;if(i&&(t=this._pageCache[e.key])&&t.pageElement)return t.pageElement;var s=this._getPageStyle(e),r=this.props.onRenderPage,n=(void 0===r?this._onRenderPage:r)({page:e,className:o.css("ms-List-page"),key:e.key,ref:e.key,style:s,role:"presentation"},this._onRenderPage);return i&&0===e.startIndex&&(this._pageCache[e.key]={page:e,pageElement:n}),n},t.prototype._getPageStyle=function(e){var t=this.props.getPageStyle;return i.__assign({},t?t(e):{},e.items?{}:{height:e.height})},t.prototype._onFocus=function(e){for(var t=e.target;t!==this._surface.current;){var i=t.getAttribute("data-list-index");if(i){this._focusedIndex=Number(i);break}t=o.getParent(t)}},t.prototype._onScroll=function(){this.state.isScrolling||this.setState({isScrolling:!0}),this._resetRequiredWindows(),this._onScrollingDone()},t.prototype._resetRequiredWindows=function(){this._requiredWindowsAhead=0,this._requiredWindowsBehind=0},t.prototype._onAsyncScroll=function(){var e,t;this._updateRenderRects(),this._materializedRect&&(e=this._requiredRect,t=this._materializedRect,e.top>=t.top&&e.left>=t.left&&e.bottom<=t.bottom&&e.right<=t.right)||this._updatePages()},t.prototype._onAsyncIdle=function(){var e=this.props,t=e.renderedWindowsAhead,i=e.renderedWindowsBehind,s=this._requiredWindowsAhead,o=this._requiredWindowsBehind,r=Math.min(t,s+1),n=Math.min(i,o+1);r===s&&n===o||(this._requiredWindowsAhead=r,this._requiredWindowsBehind=n,this._updateRenderRects(),this._updatePages()),(t>r||i>n)&&this._onAsyncIdle()},t.prototype._onScrollingDone=function(){this.setState({isScrolling:!1})},t.prototype._onAsyncResize=function(){this.forceUpdate()},t.prototype._updatePages=function(e){var t=this;void 0===e&&(e=this.props),this._requiredRect||this._updateRenderRects(e);var i=this._buildPages(e),s=this.state.pages;this._notifyPageChanges(s,i.pages),this.setState(i,function(){e.getPageHeight?t._onAsyncIdle():t._updatePageMeasurements(i.pages)?(t._materializedRect=null,t._hasCompletedFirstRender?t._onAsyncScroll():(t._hasCompletedFirstRender=!0,t._updatePages(e))):t._onAsyncIdle()})},t.prototype._notifyPageChanges=function(e,t,i){void 0===i&&(i=this.props);var s=i.onPageAdded,o=i.onPageRemoved;if(s||o){for(var r={},n=0,a=e;n<a.length;n++){(l=a[n]).items&&(r[l.startIndex]=l)}for(var h=0,d=t;h<d.length;h++){var l;(l=d[h]).items&&(r[l.startIndex]?delete r[l.startIndex]:this._onPageAdded(l))}for(var c in r)r.hasOwnProperty(c)&&this._onPageRemoved(r[c])}},t.prototype._updatePageMeasurements=function(e){var t=!1;if(!this._shouldVirtualize())return t;for(var i=0;i<e.length;i++){var s=e[i];s.items&&(t=this._measurePage(s)||t)}return t},t.prototype._measurePage=function(e){var t=!1,i=this.refs[e.key],s=this._cachedPageHeights[e.startIndex];if(i&&this._shouldVirtualize()&&(!s||s.measureVersion!==this._measureVersion)){var o={width:i.clientWidth,height:i.clientHeight};(o.height||o.width)&&(t=e.height!==o.height,e.height=o.height,this._cachedPageHeights[e.startIndex]={height:o.height,measureVersion:this._measureVersion},this._estimatedPageHeight=Math.round((this._estimatedPageHeight*this._totalEstimates+o.height)/(this._totalEstimates+1)),this._totalEstimates++)}return t},t.prototype._onPageAdded=function(e){var t=this.props.onPageAdded;t&&t(e)},t.prototype._onPageRemoved=function(e){var t=this.props.onPageRemoved;t&&t(e)},t.prototype._buildPages=function(e){var t=e.renderCount,s=e.items,r=e.startIndex,n=e.getPageHeight;t=this._getRenderCount(e);for(var a=i.__assign({},l),h=[],d=1,c=0,p=null,g=this._focusedIndex,u=r+t,_=this._shouldVirtualize(e),f=0===this._estimatedPageHeight&&!n,m=this._allowedRect,v=function(e){var t=y._getPageSpecification(e,m),i=t.height,n=t.data,l=t.key;d=t.itemCount;var v,P,R=c+i-1,b=o.findIndex(y.state.pages,function(t){return!!t.items&&t.startIndex===e})>-1,w=!m||R>=m.top&&c<=m.bottom,C=!y._requiredRect||R>=y._requiredRect.top&&c<=y._requiredRect.bottom;if(!f&&(C||w&&b)||!_||g>=e&&g<e+d||e===r){p&&(h.push(p),p=null);var S=Math.min(d,u-e),x=y._createPage(l,s.slice(e,e+S),e,void 0,void 0,n);x.top=c,x.height=i,h.push(x),C&&y._allowedRect&&(v=a,P={top:c,bottom:R,height:i,left:m.left,right:m.right,width:m.width},v.top=P.top<v.top||-1===v.top?P.top:v.top,v.left=P.left<v.left||-1===v.left?P.left:v.left,v.bottom=P.bottom>v.bottom||-1===v.bottom?P.bottom:v.bottom,v.right=P.right>v.right||-1===v.right?P.right:v.right,v.width=v.right-v.left+1,v.height=v.bottom-v.top+1)}else p||(p=y._createPage("spacer-"+e,void 0,e,0,void 0,n)),p.height=(p.height||0)+(R-c)+1,p.itemCount+=d;if(c+=R-c+1,f&&_)return"break"},y=this,P=r;P<u;P+=d){if("break"===v(P))break}return p&&(p.key="spacer-end",h.push(p)),this._materializedRect=a,{pages:h,measureVersion:this._measureVersion}},t.prototype._getPageSpecification=function(e,t){var i=this.props.getPageSpecification;if(i){var s=i(e,t),o=s.itemCount,r=void 0===o?this._getItemCountForPage(e,t):o,n=s.height;return{itemCount:r,height:void 0===n?this._getPageHeight(e,r,t):n,data:s.data,key:s.key}}return{itemCount:r=this._getItemCountForPage(e,t),height:this._getPageHeight(e,r,t)}},t.prototype._getPageHeight=function(e,t,i){if(this.props.getPageHeight)return this.props.getPageHeight(e,i);var s=this._cachedPageHeights[e];return s?s.height:this._estimatedPageHeight||30},t.prototype._getItemCountForPage=function(e,t){var i=this.props.getItemCountForPage?this.props.getItemCountForPage(e,t):10;return i||10},t.prototype._createPage=function(e,t,i,s,o,r){void 0===i&&(i=-1),void 0===s&&(s=t?t.length:0),void 0===o&&(o={}),void 0===r&&(r=void 0),e=e||"page-"+i;var n=this._pageCache[e];if(n&&n.page)return n.page;if(t)for(var a=0;a<t.length;a++)t[a]=t[a]||void 0;return{key:e,startIndex:i,itemCount:s,items:t,style:o||{},top:0,height:0,data:r}},t.prototype._getRenderCount=function(e){var t=e||this.props,i=t.items,s=t.startIndex,o=t.renderCount;return void 0===o?i?i.length-s:0:o},t.prototype._updateRenderRects=function(e,t){var i=(e=e||this.props).renderedWindowsAhead,s=e.renderedWindowsBehind,o=this.state.pages;if(this._shouldVirtualize(e)){var r=this._surfaceRect,n=this._scrollElement&&this._scrollElement.scrollHeight,a=this._scrollElement?this._scrollElement.scrollTop:0;this._surface.current&&(t||!o||!this._surfaceRect||!n||n!==this._scrollHeight||Math.abs(this._scrollTop-a)>this._estimatedPageHeight/3)&&(r=this._surfaceRect=p(this._surface.current),this._scrollTop=a),!t&&n&&n===this._scrollHeight||this._measureVersion++,this._scrollHeight=n;var h=Math.max(0,-r.top),d={top:h,left:r.left,bottom:h+window.innerHeight,right:r.right,width:r.width,height:window.innerHeight};this._requiredRect=_(d,this._requiredWindowsBehind,this._requiredWindowsAhead),this._allowedRect=_(d,s,i)}},t.defaultProps={startIndex:0,onRenderCell:function(e,t,i){return s.createElement("div",null,e&&e.name||"")},renderedWindowsAhead:2,renderedWindowsBehind:2},t}(o.BaseComponent);function _(e,t,i){var s=e.top-t*e.height,o=e.height+(t+i)*e.height;return{top:s,bottom:s+o,height:o,left:e.left,right:e.right,width:e.width}}t.List=u}),define("OfficeFabric/components/List/index",["require","exports","tslib","./List","./List.types"],function(e,t,i,s,o){Object.defineProperty(t,"__esModule",{value:!0}),i.__exportStar(s,t),i.__exportStar(o,t)}),define("OfficeFabric/List",["require","exports","tslib","./components/List/index"],function(e,t,i,s){Object.defineProperty(t,"__esModule",{value:!0}),i.__exportStar(s,t)}),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-web.fabric-list"}}));