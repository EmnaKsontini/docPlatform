"use strict";define("VSS/Features/PlatformUI",["require","exports","react","VSSUI/Util","VSS/Platform/Layout","VSS/Platform/Location","VSS/Platform/Theming","VSS/Platform/Util/Url","VSSUI/Icon","VSSUI/Image","VSS/Platform/FPS","VSSUI/Link","VSS/Platform/Context","VSS/Core/Observable","VSS/Platform/Trace"],function(e,t,n,i,o,r,s,c,u,a,d,b,m,p,l){var h,C,I,f,g,v;t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.loading="Loading",function(e){h=t.ComponentsContributedContentContributedContent={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsContributedContentContributedContent.ContributedContent=function(e){const{className:t,componentProperties:r,contribution:s,contributionId:c,dependencies:u}=e,a=Object.assign({},r,s.componentProperties,{className:i.css(t,r&&r.className,s.componentProperties&&s.componentProperties.className)}),d=[...u||[],...s.dependencies||[]];return s.uri?n.createElement(o.WrappedComponent,{dependencies:d.concat(["ms.vss-web.ext-content"]),wrappedType:"ExternalContent",wrappedProps:Object.assign({},a,{contributionId:c})}):s.componentType?n.createElement(o.WrappedComponent,{dependencies:d,wrappedType:s.componentType,wrappedProps:a}):null}}(),function(e){function o(e,t,o){let r;if(o){let u,d;if("object"==typeof o?u=o[s.getCurrentTheme(e).isDark?"dark":"light"]:(d="non-themed",u=o),u){if(!u.match(/^https?:\/\//)&&t){const n=e.getService("IVssContributionService").getContributionProvider(t);n&&(u=c.combineUrlPaths(n.baseUri,u))}r={render:e=>n.createElement(a.Image,{className:i.css(e,d,"contributed-icon-image"),src:u})}}}return r}C=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].contributedIconToIconProps=o,t[e].ContributedIcon=function(e){let t=i.css(e.className,"contributed-icon");if(e.iconProps)return n.createElement(u.Icon,Object.assign({},e.iconProps,{className:i.css(t,e.iconProps.className)}));if(e.iconAsset){let o=r.getAssetLocation(e.pageContext,e.iconAsset);if(o)return n.createElement(a.Image,{className:i.css(t,"contributed-icon-image"),src:o})}if(e.icon){const i=o(e.pageContext,e.contributionId,e.icon);if(i)return n.createElement(u.Icon,Object.assign({className:t},i))}return e.iconName?n.createElement(u.Icon,{className:t,iconName:e.iconName}):null}}("ComponentsContributedIconContributedIcon"),function(e){I=t.ComponentsFPSLinkFPSLink={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsFPSLinkFPSLink.FPSLink=class extends o.VssComponent{constructor(){super(...arguments),this.onClick=(e=>{this.props.onClick&&this.props.onClick(e),e.isDefaultPrevented()||(this.props.href&&!1!==this.props.supportsFPS?d.onClickFPS(this.context.pageContext,this.props.href,!0,e,{telemetrySource:this.props.telemetrySource,telemetryProperties:this.props.telemetryProperties,navigationId:this.props.navigationId}):this.props.telemetrySource&&this.context.pageContext.getService("IVssTelemetryService").publishEvent("WebPlatform","Link",Object.assign({},this.props.telemetryProperties||{},{source:this.props.telemetrySource})))})}render(){const e=Object.assign({},this.props,{onClick:this.onClick});return n.createElement(b.Link,Object.assign({},e))}}}(),function(e){f=t.ContributedItemUtil={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedItemUtil.getContributedItems=function(e,t,n,i){const o=[],r=e.getService("IVssContributionService"),s=[],c={},u=r.getContributionChildren(t,i);if(u)for(const e of u)c[e]=!0,s.push(e);if(n){const e=r.getContributionsByType(i);if(e)for(const i in e)if(!c[i]){const o=e[i];o&&o[n]===t&&s.push(i)}}for(const e of s){const t=r.getContribution(e);t&&o.push({id:e,contribution:t})}return o},t.ContributedItemUtil.wrapExternalObservable=function(e){if(e){const t=e,n=t.subscribe;"function"==typeof n&&(t.subscribe=((e,i)=>{m.setRemoteSerializationSettings(e,{proxyFunctions:!0}),n.call(t,e,i)}))}return e}}(),function(e){t.ContributedBreadcrumb={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedBreadcrumb.getBreadcrumbItems=function(e,t){const n=new p.ObservableCollection,i=e.getService("IVssContributionService"),o=i.getSharedData("_breadcrumbItems");if(o){const e=o[t];e&&n.push(e)}const r=f.getContributedItems(e,t,"breadcrumbId","ms.vss-web.breadcrumb-item");n.push(r,e=>({hidden:e.contribution.hidden,href:e.contribution.href,key:e.contribution.key||e.id,text:e.contribution.text,rank:e.contribution.rank,priority:e.contribution.priority}));const s=f.getContributedItems(e,t,"breadcrumbId","ms.vss-web.breadcrumb-provider");for(const e of s){const t=i.getServiceSync(e.id);t?n.push(t):i.getService(e.id).then(e=>{e&&n.push(f.wrapExternalObservable(e))})}return n}}(),g=t.ContributedContent={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedContent.ContributedContent=h.ContributedContent,v=t.ContributedIcon={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedIcon.ContributedIcon=C.ContributedIcon,t.ContributedIcon.contributedIconToIconProps=C.contributedIconToIconProps,function(e){function i(e,t){return n=>{const i=`Failed to load menu items for ${t}: ${JSON.stringify(n||"")}`;l.traceWarning(e,"extensions","ContributedMenu",i,{menuId:t}),console.warn(i)}}function r(e,t,n){let i;if(t.contribution.uri)i=new d(e,t.id,t.contribution,n);else{let o=t.contribution;!o.subMenuId&&o.menuId&&o.menuId!==t.id&&(o=Object.assign({},o,{subMenuId:o.menuId})),i=new u(e,o,n)}return i}function s(e,t,n){const i=new p.ObservableCollection;return c(e,i,t,n),i}function c(e,t,n,o){const s=e.getService("IVssContributionService"),c=s.getSharedData("_menuItems");if(c){const i=c[n];i&&i.length>0&&t.push(i,t=>r(e,{id:t.id,contribution:t},o))}t.push(f.getContributedItems(e,n,"menuId","ms.vss-web.menu-item"),t=>r(e,t,o)),t.push(f.getContributedItems(e,n,"menuId","ms.vss-web.action"),t=>r(e,t,o));const u=[...f.getContributedItems(e,n,"menuId","ms.vss-web.menu-provider"),...f.getContributedItems(e,n,"menuId","ms.vss-web.action-provider")];for(const r of u){let c=s.getServiceSync(r.id,!0);if(c){if(c.getMenuItems){const e=c.getMenuItems(n);e&&t.push(e)}}else{const c=r.contribution;if(c.uri){const u={serviceName:c.registeredObjectId||r.id,uri:c.uri};s.getServiceEx(r.id,u,!0).then(s=>{s&&s.getMenuItems&&s.getMenuItems(n).then(n=>{t.push(n,t=>new d(e,r.id,Object.assign({uri:c.uri},t),o))},i(e,r.id))},i(e,r.id))}else s.getService(r.id).then(e=>{if(e&&e.getMenuItems){const i=e.getMenuItems(n);i&&t.push(i)}})}}}t.ContributedMenu={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedMenu.getMenuItems=s,t.ContributedMenu.addMenuItems=c;class u{constructor(e,t,i){this.onActivateCommand=(e=>{const t=this.pageContext.getService("IVssContributionService"),n=this.contextualData?Object.assign({},this.data,this.contextualData.value):this.data;this.command?t.executeCommandEx(e.id,this.command,n):t.getService(e.id,!0).then(e=>{e&&e.execute&&e.execute(n)})}),this.renderMenuItemCustom=((e,t,i)=>n.createElement(o.WrappedComponent,{key:this.id,wrappedType:this.componentType,wrappedProps:{index:e,item:t,details:i}})),this.pageContext=e,this.className=t.className,this.checked=t.checked,this.data=t.data,this.contextualData=i,this.disabled=t.disabled,this.groupKey=t.groupKey,this.href=t.href,this.iconProps=t.iconProps,this.id=t.id||t.key||"",this.rank=t.rank,this.rel=t.rel,this.target=t.target,this.text=t.text||t.name,"-"===t.name?this.itemType=1:this.itemType=t.itemType,this.command=t.command,!this.command&&this.href||(this.onActivate=this.onActivateCommand);const r=t.subMenuId;r&&(this.subMenuProps={id:r,items:s(e,r)}),this.componentType=t.componentType,this.componentType&&(this.renderMenuItem=this.renderMenuItemCustom)}}let a=0;class d{constructor(e,t,n,o){if(this.onActivateExternalCommand=(()=>{this.pageContext.getService("IVssContributionService").getServiceEx(this.contributionId,this.externalContributedService,!0).then(e=>{e&&e.execute&&e.execute(this.contextualData.value)},i(this.pageContext,this.contributionId))}),this.pageContext=e,this.contributionId=t,this.contextualData=o||new p.ObservableValue(void 0),this.disabled=n.disabled,this.groupKey=n.groupId,this.href=n.href,this.id=n.id||"ext-menu-"+ ++a,this.rank=n.rank,this.text=n.text||n.title,n.icon&&(this.iconProps=v.contributedIconToIconProps(e,t,n.icon)),n.action?this.onActivate=(()=>{n.action(this.contextualData.value)}):n.uri&&(this.externalContributedService={serviceName:n.registeredObjectId||t,uri:n.uri,configuration:this.contextualData.value},this.onActivate=this.onActivateExternalCommand),n.childItems){const o=new p.ObservableArray;"function"==typeof n.childItems.then?n.childItems.then(i=>{o.push(...i.map(i=>new d(e,t,Object.assign({uri:n.uri},i),this.contextualData)))},i(e,this.contributionId)):o.push(...n.childItems.map(i=>new d(e,t,Object.assign({uri:n.uri},i),this.contextualData))),this.subMenuProps={id:"ext-sub-menu-"+ ++a,items:o}}}}}(),function(e){function i(e,t,i,o){if(i.render||(i.render=(()=>n.createElement(g.ContributedContent,{key:o,className:"flex-grow",contributionId:o,contribution:i,dependencies:i.dependencies,componentProperties:t.props}))),i.id||(i.id=o),i.routeId){const n=e.getService("IVssLocationService");i.url=n.routeUrl(i.routeId,Object.assign({},t.routeValues,i.routeValues))}else if(t.defaultRouteId){const n=e.getService("IVssLocationService");i.url=n.routeUrl(t.defaultRouteId,{contributionId:o})}return i.fpsRequired||t.fpsRequired?i.onBeforeTabChange=((t,n,i)=>!i||(d.FastPageSwitch(e,i,!0),t&&t.preventDefault(),!1)):i.url&&t.updateUrlOnPivotChange&&(i.onBeforeTabChange=((t,n,o)=>{return e.getService("IVssHistoryService").pushState(void 0,i.url&&p.ObservableLike.getValue(i.url)),!0})),i}function o(e,t,n,o={}){const r=e.getService("IVssContributionService"),s=f.getContributedItems(e,n,"tabId","ms.vss-web.tab");t.push(s,t=>i(e,o,t.contribution,t.id));const c=f.getContributedItems(e,n,"tabId","ms.vss-web.tab-provider");for(const n of c){const s=r.getServiceSync(n.id,!0);s?t.push(s,t=>i(e,o,t,t.id)):r.getService(n.id).then(n=>{n&&t.push(f.wrapExternalObservable(n),t=>i(e,o,t,t.id))})}}t.ContributedTab={},Object.defineProperty(t,"__esModule",{value:!0}),t.ContributedTab.getTabs=function(e,t,n={}){const i=new p.ObservableCollection;return o(e,i,t,n),i},t.ContributedTab.addTabs=o}(),t.FPSLink={},Object.defineProperty(t,"__esModule",{value:!0}),t.FPSLink.FPSLink=I.FPSLink},["Resources","Components/ContributedContent/ContributedContent","Components/ContributedIcon/ContributedIcon","Components/FPSLink/FPSLink","ContributedItemUtil","ContributedBreadcrumb","ContributedContent","ContributedIcon","ContributedMenu","ContributedTab","FPSLink"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.platform-ui-content"}}));