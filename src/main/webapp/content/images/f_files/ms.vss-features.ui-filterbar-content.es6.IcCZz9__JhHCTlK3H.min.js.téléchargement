"use strict";define("VSSUI",["require","exports","react","VSS/Core/Util/Accessibility","VSS/Core/Util/String"],function(e,t,s,i,r){var l,o,n;l=t.ResourcesFilterBar={},Object.defineProperty(t,"__esModule",{value:!0}),t.ResourcesFilterBar.ClearAndDismissFilterBarLinkLabel="Clear and dismiss filters",t.ResourcesFilterBar.ClearFilterBarLinkLabel="Clear filters",t.ResourcesFilterBar.FilterPageLeftAriaLabel="See previous group of filters",t.ResourcesFilterBar.FilterPageRightAriaLabel="See next group of filters",t.ResourcesFilterBar.AnnonuceVisibleFilters="Showing filters {0} through {1}",t.ResourcesFilterBar.ApplyChangesFilterBarText="Apply",function(e){o=t.ComponentsFilterBarFilterBar={},Object.defineProperty(t,"__esModule",{value:!0});class n extends s.Component{constructor(e){if(super(e),this._firstChildIsKeywordItem=!1,this._prevContainerWidth=0,this._onResize=(()=>{this._resizeTimeout||(this._resizeTimeout=setTimeout(()=>{if(this._resizeTimeout=null,this._isMounted){const e=this._prevContainerWidth<this._filterBarElement.clientWidth,t=(!this.state.shouldHidePlaceholderLabels||!e)&&this.state.shouldHidePlaceholderLabels,s=(!this.state.shouldHaveMaxItemWidth||!e)&&this.state.shouldHaveMaxItemWidth;this.setState({filtersToShowStopIndex:n.RENDER_EVERYTHING,shouldHidePlaceholderLabels:t,shouldHaveMaxItemWidth:s}),this._prevContainerWidth=this._filterBarElement.clientWidth}},100))}),this._onPageLeft=(()=>{this._hasMadeVisibleFilterAnnouncement=!1;const e=this._startingFilterIndices.pop()||0;this._hasPagedLeft=!0,this.setState({filtersToShowStartIndex:e,filtersToShowStopIndex:n.RENDER_EVERYTHING})}),this._onPageRight=(()=>{this._hasMadeVisibleFilterAnnouncement=!1,this._startingFilterIndices.push(this.state.filtersToShowStartIndex),this._hasPagedRight=!0,this.setState({filtersToShowStartIndex:this.state.filtersToShowStopIndex,filtersToShowStopIndex:n.RENDER_EVERYTHING})}),this._calculateFiltersToShowStopIndex=(()=>{let e=this._rightElement.clientWidth;const t=this._firstChildIsKeywordItem?1:0;for(let s=0;s<this._childrenContainerElements.length;s++){const i=this._childrenContainerElements[s];if((e+=i.clientWidth+parseFloat(window.getComputedStyle(i).marginRight))>this._filterBarElement.clientWidth){const e=this.state.filtersToShowStartIndex+(s-t);return e>this.state.filtersToShowStartIndex?e:this.state.filtersToShowStartIndex+1}}return this.state.filtersToShowStartIndex+this._childrenContainerElements.length-t}),this._onFilterChanged=(e=>{this.setState({hasChangesToApply:this.props.filter.hasChangesToApply(),hasChangesToReset:this.props.filter.hasChangesToReset(),filtersToShowStopIndex:n.RENDER_EVERYTHING,shouldHidePlaceholderLabels:!1})}),this._onFilterApplied=(e=>{this.setState({hasChangesToApply:this.props.filter.hasChangesToApply()})}),this._onClearAndDismiss=(()=>{this.props.filter.reset(),this.props.onDismissClicked&&this.props.onDismissClicked()}),this._onApplyChanges=(()=>{this.props.filter.applyChanges(),this.focus()}),!e.filter)throw new Error("Cannot create a FilterBar without a filter prop.");this._startingFilterIndices=[],this._hasMadeVisibleFilterAnnouncement=!1,this._isMounted=!1,this.state={hasChangesToReset:e.filter.hasChangesToReset(),hasChangesToApply:e.filter.hasChangesToApply(),filtersToShowStartIndex:0,filtersToShowStopIndex:n.RENDER_EVERYTHING,shouldHidePlaceholderLabels:!1,shouldHaveMaxItemWidth:!1}}focus(){this._filterItemRefs&&this._filterItemRefs.length>0&&this._filterItemRefs[0].focus()}forceUpdate(){super.forceUpdate(),this._filterItemRefs&&this._filterItemRefs.forEach(e=>e.forceUpdate())}componentDidMount(){this.props.filter&&this.props.filter.subscribe(this._onFilterChanged,t.UtilitiesFilter.FILTER_CHANGE_EVENT),this.props.filter&&this.props.filter.subscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),window.addEventListener("resize",this._onResize);const e=this._calculateFiltersToShowStopIndex();e<s.Children.toArray(this.props.children).length-1?this.setState({shouldHidePlaceholderLabels:!0}):this.setState({filtersToShowStopIndex:e}),this._isMounted=!0,this.props.onMounted&&this.props.onMounted(this)}getChildKeysAsString(e){let t=e.children&&s.Children.map(e.children,e=>{if(null===e)return null;return void 0===e?"":e.props.filterItemKey})||[];return JSON.stringify(t)}componentWillReceiveProps(e){this.getChildKeysAsString(this.props)!==this.getChildKeysAsString(e)?this.setState({hasChangesToApply:e.filter.hasChangesToApply(),hasChangesToReset:e.filter.hasChangesToReset(),filtersToShowStartIndex:0,filtersToShowStopIndex:n.RENDER_EVERYTHING}):this.setState({hasChangesToApply:e.filter.hasChangesToApply(),hasChangesToReset:e.filter.hasChangesToReset()})}componentWillUnmount(){this.props.filter&&this.props.filter.unsubscribe(this._onFilterChanged,t.UtilitiesFilter.FILTER_CHANGE_EVENT),this.props.filter&&this.props.filter.unsubscribe(this._onFilterApplied,t.UtilitiesFilter.FILTER_APPLIED_EVENT),window.removeEventListener("resize",this._onResize),this._isMounted=!1}componentDidUpdate(){if(this.props.onRenderComplete&&this.props.onRenderComplete(),this._hasPagedLeft&&this.state.filtersToShowStopIndex>0&&(0==this.state.filtersToShowStartIndex&&this._nextButtonElem&&this._nextButtonElem.focus(),this._hasPagedLeft=!1),this.state.filtersToShowStopIndex<0){const e=this._calculateFiltersToShowStopIndex(),t=this._firstChildIsKeywordItem?1:0,i=e===s.Children.toArray(this.props.children).length-t;i||this.state.shouldHidePlaceholderLabels?i||this.state.shouldHaveMaxItemWidth?(this._hasPagedRight&&e===this.state.filtersToShowStartIndex+this._childrenContainerElements.length-t&&this._prevButtonElem&&this._prevButtonElem.focus(),this.setState({filtersToShowStopIndex:e}),this._hasPagedRight=!1):this.setState({shouldHaveMaxItemWidth:!0}):this.setState({shouldHidePlaceholderLabels:!0})}else this._hasMadeVisibleFilterAnnouncement||(i.announce(r.format(l.AnnonuceVisibleFilters,this.state.filtersToShowStartIndex+1,this.state.filtersToShowStopIndex),!0),this._hasMadeVisibleFilterAnnouncement=!0)}render(){const{children:e,filter:i,className:r,onDismissClicked:o}=this.props,{hasChangesToApply:n,hasChangesToReset:a,filtersToShowStopIndex:h,filtersToShowStartIndex:d,shouldHaveMaxItemWidth:p,shouldHidePlaceholderLabels:c}=this.state;this._filterItemRefs=[],this._childrenContainerElements=[];let f=!0;this._firstChildIsKeywordItem=!1;let u,m=s.Children.map(e,e=>{if(null===e)return null;let r="vss-FilterBar--item";const l=e;f&&l.props.isTextItem?(this._firstChildIsKeywordItem=!0,r=t.Util.css(r,"vss-FilterBar--item-keyword-container")):p&&(r=t.Util.css(r,"max-width-small")),f=!1;const o=s.cloneElement(l,{filter:l.props.filter||i,ref:e=>{e&&this._filterItemRefs.push(e)},hideSelectedItemIcon:!0,showPlaceholderAsLabel:!c});return s.createElement("div",{className:r,ref:e=>{e&&this._childrenContainerElements.push(e)}},o)});this._firstChildIsKeywordItem&&(u=m.shift());const _=h<m.length,S=d>0;if(_||S){const e=h>0?h:m.length;m=m.slice(d,e)}const C=o?l.ClearAndDismissFilterBarLinkLabel:l.ClearFilterBarLinkLabel;return s.createElement(t.Surface.SurfaceContext.Consumer,null,e=>s.createElement("div",{className:t.Util.css(r,"vss-FilterBar",1===e.background&&"bolt-filterbar-white depth-8")},s.createElement("div",{className:t.Util.css("vss-FilterBar--list",!u&&"justify-right"),ref:e=>{this._filterBarElement=e}},u,m,s.createElement("div",{className:"vss-FilterBar--right-items",ref:e=>{this._rightElement=e}},(S||_)&&s.createElement("div",{className:"vss-FilterBar--page-button-container"},s.createElement(t.Button.Button,{className:"filter-bar-button  vss-FilterBar-page-button",ref:e=>{this._prevButtonElem=e},onClick:this._onPageLeft,disabled:!S,ariaLabel:l.FilterPageLeftAriaLabel,iconProps:{iconName:"ChevronLeft"}}),s.createElement(t.Button.Button,{className:"filter-bar-button vss-FilterBar-page-button",ref:e=>{this._nextButtonElem=e},onClick:this._onPageRight,disabled:!_,ariaLabel:l.FilterPageRightAriaLabel,iconProps:{iconName:"ChevronRight"}})),!this.props.hideClearAction&&s.createElement("div",{className:"vss-FilterBar--action vss-FilterBar--action-clear"},s.createElement(t.Button.Button,{ariaLabel:C,className:"filter-bar-button",disabled:!a&&!o,iconProps:{iconName:"Cancel"},onClick:this._onClearAndDismiss,subtle:!0,tooltipProps:{text:C}})),i.usesApplyMode()&&s.createElement("div",{className:"vss-FilterBar--action vss-FilterBar--action-apply"},s.createElement(t.Button.Button,{className:"filter-bar-button",disabled:!n,onClick:this._onApplyChanges,iconProps:{iconName:"CheckMark"}},l.ApplyChangesFilterBarText))))))}}n.RENDER_EVERYTHING=-1,t.ComponentsFilterBarFilterBar.FilterBar=n}(),function(e){n=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}(o)}("ComponentsFilterBarindex"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}(n)}("FilterBar")},["Resources.FilterBar","Components/FilterBar/FilterBar","Components/FilterBar/index","FilterBar"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-filterbar-content"}}));