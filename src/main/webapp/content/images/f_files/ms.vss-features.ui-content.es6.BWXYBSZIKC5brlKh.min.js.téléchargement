"use strict";define("VSSUI",["require","exports","react","react-dom","OfficeFabric/ContextualMenu","VSS/Core/EventManagement","OfficeFabric/Icon","VSS/Core/Util/Object","OfficeFabric/Utilities","OfficeFabric/Tooltip","VSS/Core/Observable","VSS/Platform/Layout"],function(e,t,i,s,o,n,a,r,l,u,c,p){var h,m,S,d,v,g,V,f,b,I,P,w,_,O,y,C,N,x,U,E,M,T,k,R,F,D,A,B;h=t.VSSResourcesVSSUI={},Object.defineProperty(t,"__esModule",{value:!0}),t.VSSResourcesVSSUI.MoreActionsText="More Actions...",t.VSSResourcesVSSUI.DateTimePicker_CannotParseTime="cannot parse",t.VSSResourcesVSSUI.DateTimeRangePicker_End="End",t.VSSResourcesVSSUI.DateTimeRangePicker_Start="Start",t.VSSResourcesVSSUI.DateTimeRangePicker_StartDate="Start Date",t.VSSResourcesVSSUI.DateTimeRangePicker_StartTime="Start Time",t.VSSResourcesVSSUI.DateTimeRangePicker_EndDate="End Date",t.VSSResourcesVSSUI.DateTimeRangePicker_EndTime="End Time",t.VSSResourcesVSSUI.PivotBarViewActionOffText="Off",t.VSSResourcesVSSUI.PivotBarViewActionOnText="On",t.VSSResourcesVSSUI.DateTimePicker_DateFieldAriaLabel="Date",t.VSSResourcesVSSUI.DateTimePicker_TimeFieldAriaLabel="Time",t.VSSResourcesVSSUI.PickListClearActionText="Clear",t.VSSResourcesVSSUI.PickListSelectAllActionText="Select all",t.VSSResourcesVSSUI.FilterOperatorAnd="And",t.VSSResourcesVSSUI.FilterOperatorOr="Or",t.VSSResourcesVSSUI.FilterTextItemClearLabel="Clear the filter input",t.VSSResourcesVSSUI.PivotBarViewOptionsText="View options",t.VSSResourcesVSSUI.PivotBarFilterActionTextHide="Hide filters",t.VSSResourcesVSSUI.PivotBarFilterActionTextShow="Show filters",t.VSSResourcesVSSUI.EnterFullScreenAriaLabel="Enter full screen mode",t.VSSResourcesVSSUI.ExitFullScreenAriaLabel="Exit full screen mode",t.VSSResourcesVSSUI.FilterDropdownLabel="{0} filter:",t.VSSResourcesVSSUI.PivotBarFullScreenText="Full screen mode toggle",t.VSSResourcesVSSUI.BreadcrumbAriaLabel="Breadcrumbs",t.VSSResourcesVSSUI.PivotBarMoreCommandsAriaLabel="More commands",t.VSSResourcesVSSUI.PivotBarMoreOptionsAriaLabel="More options",t.VSSResourcesVSSUI.PivotBarChoiceGroupCycleAriaLabel="Click to cycle through options",t.VSSResourcesVSSUI.FileInputBrowseButtonLabel="Browse...",t.VSSResourcesVSSUI.FileInputDragDropLabel="Drag and drop files here or click browse to select a file",t.VSSResourcesVSSUI.FileInputDragDropSingleFileLabel="Drag and drop a file here or click browse to select a file.",t.VSSResourcesVSSUI.FileInputErrorDuplicateFileName='Duplicate file: "{0}". Cannot upload two files with the same file name.',t.VSSResourcesVSSUI.FileInputErrorNotAllowedExtensionType="File extention {0} is not supported. Allowed Extensions : {1}",t.VSSResourcesVSSUI.FileInputErrorLabel="Error",t.VSSResourcesVSSUI.FileInputErrorMaxFileSize="File {0} is {1} which exceeds the maximum size allowed for upload of a single file ({2}).",t.VSSResourcesVSSUI.FileInputErrorMaxNumFiles="Only {0} files are allowed to be uploaded at one time.",t.VSSResourcesVSSUI.FileInputErrorSingleFileOnly="Only a single file can be uploaded at a time.",t.VSSResourcesVSSUI.FileInputErrorTotalFileSize="The files being added total {0} which exceeds the maximum total size allowed to be uploaded ({1}).",t.VSSResourcesVSSUI.FileInputReadErrorFormat="Failed to read file {0}: {1}",t.VSSResourcesVSSUI.FileInputRemoveAll="remove all",t.VSSResourcesVSSUI.FileInputRemoveFile="remove",t.VSSResourcesVSSUI.FileSizeBytesFormat="{0} bytes",t.VSSResourcesVSSUI.FileSizeKBFormat="{0} KB",t.VSSResourcesVSSUI.FileSizeMBFormat="{0} MB",t.VSSResourcesVSSUI.Loading="Loading...",t.VSSResourcesVSSUI.Searching="Searching...",t.VSSResourcesVSSUI.NoFilterResults="No items matched the supplied filter",t.VSSResourcesVSSUI.PickListClearActionAriaLabel="Clear filter",t.VSSResourcesVSSUI.AnnouncePickListItemSelect="List item selected",t.VSSResourcesVSSUI.AnnouncePickListItemDeselect="List item deselected",t.VSSResourcesVSSUI.AnnounceFilterCleared="Filter selection cleared",t.VSSResourcesVSSUI.AnnounceFilterResultCount="Showing {0} filtered items.",t.VSSResourcesVSSUI.AnnounceLoadingItems="Loading items",t.VSSResourcesVSSUI.AnnounceFinishedLoadingItems="Finished loading items",t.VSSResourcesVSSUI.AnnounceErrorLoadingItems="Error loading items",t.VSSResourcesVSSUI.PivotItemAriaLabel="Pivot item",t.VSSResourcesVSSUI.FilterDropdownLabelNoSelection="{0} filter",t.VSSResourcesVSSUI.PeoplePickerLoadingText="Loading identities...",t.VSSResourcesVSSUI.PeoplePickerResultsFoundText="Showing {0} results",t.VSSResourcesVSSUI.PeoplePickerPlaceholderText="Search users and groups",t.VSSResourcesVSSUI.PeoplePickerNoResultsText="No identities found",t.VSSResourcesVSSUI.PeoplePickerContact="Contact",t.VSSResourcesVSSUI.PeoplePickerStartChat="Start chat",t.VSSResourcesVSSUI.PeoplePickerOrganization="Organization",t.VSSResourcesVSSUI.PeoplePickerReportingTo="Reporting to {0} ({1})",t.VSSResourcesVSSUI.PeoplePickerReportsTo="Reports to",t.VSSResourcesVSSUI.PeoplePickerProfileCardAriaLabel="Contact card",t.VSSResourcesVSSUI.PeoplePickerHeaderButtonLabel="Go back",t.VSSResourcesVSSUI.PeoplePickerContactInfo="Contact information",t.VSSResourcesVSSUI.PeoplePickerEmail="Email",t.VSSResourcesVSSUI.PeoplePickerPhoneNumber="Phone number",t.VSSResourcesVSSUI.PeoplePickerLocation="Location",t.VSSResourcesVSSUI.PeoplePickerTitle="Title",t.VSSResourcesVSSUI.PeoplePickerDepartment="Department",t.VSSResourcesVSSUI.PeoplePickerAlias="Alias",function(e){m=t.ComponentsVssContextualMenuVssContextualMenu={},Object.defineProperty(t,"__esModule",{value:!0});class a extends i.Component{constructor(e){super(e),this._invalidateItem=(e=>{let t=!1;if(this.subMenuId){const i=this._findMenuItems(this.subMenuId),s=this._findItemIndex(i,e);t=this._focusItem(i,s-1)}if(!t){const i=this._findMenuItems(this.props.id),s=this._findItemIndex(i,e);(t=this._focusItem(i,s-1))||(s>0?t=this._focusItem(i,0):this._setTimeout(()=>{const e=this._findMenuItems(this.props.id);this._focusItem(e,0)},0))}!t&&this._activeElement&&this.contains(document.activeElement)&&this._activeElement.focus()}),this._itemsChanged=((e,t,i)=>{if(this._isMounted){const s={};this._items.forEach(e=>{t&&-1!==t.indexOf(e.key)||(s[e.key]=e)}),e.forEach(e=>{e.invalidateItem=(()=>{this._invalidateItem(e.key)}),s[e.key]=e});const o=[];Object.keys(s).forEach(e=>{o.push(s[e])}),this._items=o,this.setState({displayItems:this._arrangeItems(o,i)})}}),this._onDismiss=((e,t)=>{this._activeElement&&this.contains(document.activeElement)&&this._activeElement.focus(),this.props.onDismiss(e,t)}),this._onRenderSubMenu=(e=>(this.subMenuId=e.id,e.items&&e.items.forEach(e=>{e.invalidateItem=(()=>{this._invalidateItem(e.key)})}),i.createElement(a,Object.assign({ref:e=>{this._submenuComponent=e}},e)))),this.timers=[],this._items=[],this._groups=[],this.events=new n.EventManagement,this.state={displayItems:[]}}render(){if(this.state.loadingTimeout)return null;const{displayItems:e}=this.state,{className:s,directionalHint:n,gapSpace:a=5}=this.props;let r=!(!this._items||!this._items.some(e=>!!e.icon||!!e.iconProps));return this._items.forEach(e=>{e.menuHasIcons=r,!r||e.iconProps||e.icon||(e.iconProps={iconName:""})}),i.createElement(o.ContextualMenu,Object.assign({gapSpace:a,directionalHint:n},this.props,{items:e,className:t.Util.css("vss-contextualMenu-list",s),onDismiss:this._onDismiss,onRenderSubMenu:this._onRenderSubMenu}))}componentWillMount(){const e=this._setTimeout(()=>{this.setState({loadingTimeout:void 0})},100);this._items=this.props.items||[],this._groups=this.props.groups||[],this.setState({displayItems:this.props.items?this._arrangeItems(this.props.items):[],loadingTimeout:e}),this.props.isSubMenu||(a._activeMenu&&a._activeMenu.dismiss(null,!0),a._activeMenu=this),this._activeElement=document.activeElement}componentWillUnmount(){if(this._isMounted=!1,this.state.loadingTimeout&&this._clearTimeout(this.state.loadingTimeout),this.timers){for(const e of this.timers)window.clearTimeout(e);this.timers=[]}this.events&&this.events.removeAllListeners(),a._activeMenu===this&&delete a._activeMenu}componentDidMount(){if(this._isMounted=!0,"string"==typeof this.props.target?this._targetElement=document.querySelector(this.props.target):this._targetElement=this.props.target,this.props.providers&&this.props.providers.length>0){const e=this.props.providers.map((e,t)=>t);for(let t=0;t<this.props.providers.length;t++){this.props.providers[t].loadItems((e,t,i)=>{this._itemsChanged(e,t,i)},()=>{if(this.state.loadingTimeout){const i=e.indexOf(t);i>-1&&(e.splice(i,1),this._isMounted&&0===e.length&&this.setState({loadingTimeout:void 0}))}})}}else this.setState({loadingTimeout:void 0});this.props.mouseLeaveDelayMs&&this.events.addEventListener(document.body,"mousemove",e=>{this._targetElement.contains(e.target)||this.contains(e.target)?this.closeTimeout&&(this._clearTimeout(this.closeTimeout),delete this.closeTimeout):this.closeTimeout||(this.closeTimeout=this._setTimeout(()=>{delete this.closeTimeout,this.dismiss(e,!0)},this.props.mouseLeaveDelayMs||0))}),this.events.addEventListener(document,"keydown",e=>{"`"!==e.key||e.defaultPrevented?16===e.which||17===e.which||18===e.which||this.props.isSubMenu||this.props.shouldFocusOnMount||this.contains(document.activeElement)||this.dismiss(e,!0):(this._forceGroupNames=!this._forceGroupNames,this.setState({displayItems:this._arrangeItems(this._items)}))})}componentWillReceiveProps(e){if(e.isSubMenu){const t=this.props.items||[],i=e.items||[];let s=t.length!==i.length;s||(s=t.some(e=>!i.some(t=>t.key===e.key))),s&&this.setState({displayItems:i?this._arrangeItems(i):[]})}}contains(e){return this._isMounted&&t.UtilitiesDom.elementContains(s.findDOMNode(this),e)||this._submenuComponent&&this._submenuComponent.contains(e)}dismiss(e,t){this.props.onDismiss&&this.props.onDismiss(e,!0)}_arrangeItems(e,t){const i=e.some(e=>e.rank>=0),s=e.some(e=>!!e.groupKey);return e=[...e],i&&this._sortItems(e),s&&(e=this._groupItems(e,t)),this._removeConsecutiveSeparators(e),e}_clearTimeout(e){if(this.timers){const t=this.timers.indexOf(e);this.timers.splice(t,1)}window.clearTimeout(e)}_findMenuItems(e){const t=document.querySelector("#"+e);if(t)return t.querySelectorAll("[role='menuitem']")}_findItemIndex(e,t){let i=-1;if(e&&e.length>1)for(let s=0;s<e.length;s++){const o=e.item(s);if(o.parentElement&&o.parentElement.id===t){i=s;break}}return i}_focusItem(e,t){let i=!1;if(e&&e.length>t&&t>-1){e.item(t).focus(),i=!0}return i}_groupItems(e,t){const i={};let s=0;const n=[],a=this._forceGroupNames;if(this._groups){s=this._groups.reduce((e,t)=>t.rank>e?t.rank:e,0);for(const e of this._groups)i[e.key]={key:e.key,name:e.name,rank:void 0===e.rank?++s:e.rank,showGroupName:e.showGroupName,items:[]}}else this._groups=[];if(t)for(const e of t){i[e.key]||(i[e.key]={key:e.key,name:e.name,rank:void 0===e.rank?++s:e.rank,showGroupName:e.showGroupName,items:[]},this._groups.push(e))}for(const t of e)t.groupKey?i[t.groupKey]?i[t.groupKey].items.push(t):i[t.groupKey]={key:t.groupKey,name:t.groupKey,rank:++s,items:[t]}:n.push(t);const r=Object.keys(i).map(e=>i[e]);r.sort((e,t)=>(e.rank||Number.MAX_VALUE)-(t.rank||Number.MAX_VALUE)),r.push({key:"ungrouped",name:"Ungrouped",rank:++s,items:n}),r.forEach(e=>{const t=e.items;for(;t.length>0&&t[0].itemType===o.ContextualMenuItemType.Divider;)t.shift();for(;t.length>0&&t[t.length-1].itemType===o.ContextualMenuItemType.Divider;)t.pop()}),e=[];let l=!0;for(const t of r)(0!==t.items.length||a)&&(t.showGroupName&&t.name||a?e.push({key:`group_${t.name}`,itemType:o.ContextualMenuItemType.Header,name:a?`${t.name} (key: ${t.key})`:t.name}):l||e.push({key:`divider_${t.name}`,itemType:o.ContextualMenuItemType.Divider}),l&&(l=!1),e=e.concat(t.items));return e}_removeConsecutiveSeparators(e){let t=!0;for(let i=e.length-1;i>=0;i--){const s=e[i].itemType===o.ContextualMenuItemType.Divider||"-"===e[i].name;s&&t&&e.splice(i,1),t=s}}_setTimeout(e,t,...i){const s=window.setTimeout(e,t,...i);return this.timers||(this.timers=[]),this.timers.push(s),s}_sortItems(e){e.sort((e,t)=>{return(e.rank||Number.MAX_VALUE)-(t.rank||Number.MAX_VALUE)})}}t.ComponentsVssContextualMenuVssContextualMenu.VssContextualMenu=a}(),function(e){S=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(m)}("ComponentsVssContextualMenuindex"),function(e){d=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(S)}("VssContextualMenu"),function(e){v=t.ComponentsVssIconVssIcon={},Object.defineProperty(t,"__esModule",{value:!0});class s extends i.Component{constructor(e){super(e),this.state={}}render(){return i.createElement(a.Icon,Object.assign({},s.getIconProps(this.props)),this.props.children)}static getIconProps(e,i){const o=Object.assign({},e);delete o.iconType,delete o.iconName;let n=e.iconType;!n&&e.iconName&&e.iconName.substr(0,s.bowtieIconPrefix.length)===s.bowtieIconPrefix&&(n=1),o.iconType=3===e.iconType?a.IconType.image:a.IconType.default;const r=t.Util.css("vss-Icon",i);if(o.className?o.className=`${o.className} ${r}`:o.className=r,1===n){let i=e.iconName;"string"==typeof i&&i.substr(0,s.bowtieIconPrefix.length)!==s.bowtieIconPrefix&&(i=s.bowtieIconPrefix+i);const n=t.Util.css("vss-Icon--bowtie",i);o.className=`${o.className} ${n}`}else o.iconName=e.iconName;return o}}s.bowtieIconPrefix="bowtie-",t.ComponentsVssIconVssIcon.VssIcon=s}(),function(e){g=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(v)}("ComponentsVssIconindex"),function(e){V=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(g)}("VssIcon"),function(e){f=t.ComponentsContextualMenuButtonContextualMenuButton={},Object.defineProperty(t,"__esModule",{value:!0});class s extends i.Component{constructor(e){super(e),this._onClick=(e=>{const{onClick:t,useTargetPoint:i}=this.props;t&&t(e)||e.stopPropagation(),this.state.isOpen?this.close():(this.setState({items:this.props.getItems?this.props.getItems():[]}),e.clientX&&i?this.setState({isOpen:!0,providers:this.props.getItemProviders?this.props.getItemProviders():[],useTargetPoint:!0,target:{x:e.clientX,y:e.clientY}}):this.setState({isOpen:!0,providers:this.props.getItemProviders?this.props.getItemProviders():[],useTargetPoint:!1}))}),this._onDismiss=(()=>{this._isMounted&&(this.props.onDismiss&&this.props.onDismiss(),this.close())}),this.close=(()=>{this.setState({target:null,isOpen:!1,useTargetPoint:!1,items:void 0,providers:void 0},()=>this.focus())}),this.props.isOpen?this.state={isOpen:!0,providers:this.props.getItemProviders?this.props.getItemProviders():[],items:this.props.getItems?this.props.getItems():[]}:this.state={items:void 0,providers:void 0,isOpen:!1},this._contextMenuExpandedId=r.getId("context-menu-expanded")}focus(){this._button&&this._button.focus&&this._button.focus()}componentWillReceiveProps(e){e.isOpen&&!this.state.items&&this.setState({items:this.props.getItems?this.props.getItems():[],providers:this.props.getItemProviders?this.props.getItemProviders():[]})}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{className:e,ctaButton:o,directionalHint:n,iconProps:a,title:r,allocateSpaceWhileHidden:l,dataIndex:u,onFocus:c,tabIndex:p}=this.props,h=this.state.isOpen||this.props.isOpen||!1,m=this.props.showTooltip&&!h,S=this.state.target||this.props.target||this.props.targetPoint;let v=this.state.useTargetPoint||this.props.useTargetPoint;void 0===v&&(v=S&&void 0!==S.x&&void 0!==S.y);const g={ariaControls:h?this._contextMenuExpandedId:null,ariaExpanded:h,ariaHasPopup:!0,ariaLabel:r,className:t.Util.css("vss-ContextualMenuButton","contextual-menu-button",e,h&&"open",l&&"space-allocated",!l&&"space-unallocated"),dataIndex:u,excludeTabStop:-1===p,onClick:this._onClick,onFocus:c,primary:o};r&&m&&(g.tooltipProps={anchorOrigin:{horizontal:"center",vertical:"end"},showOnFocus:!0,text:r,tooltipOrigin:{horizontal:"center",vertical:"start"}});let f=i.createElement(t.Button.Button,Object.assign({ref:e=>this._button=e},g),a&&i.createElement(t.Icon.Icon,Object.assign({},V.VssIcon.getIconProps(a))));return i.createElement("div",{className:s.ButtonContainerClassName,ref:s.buttonRef},f,h&&this.state.items&&i.createElement(d.VssContextualMenu,{providers:this.state.providers,items:this.state.items,onDismiss:this._onDismiss,shouldFocusOnMount:!0,gapSpace:v?5:0,directionalHint:n,target:S||this.refs[s.buttonRef],ariaLabel:r}))}}s.ButtonContainerClassName="vss-ContextualMenu--container",s.buttonRef="button",t.ComponentsContextualMenuButtonContextualMenuButton.ContextualMenuButton=s}(),function(e){b=t.ComponentsContextualMenuButtonDropdownButton={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsContextualMenuButtonDropdownButton.DropdownButton=class extends i.Component{render(){return i.createElement(f.ContextualMenuButton,Object.assign({},this.props,{iconProps:{iconName:"ChevronDown"}}))}}}(),function(e){I=t.ComponentsContextualMenuButtonMoreActionsButton={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsContextualMenuButtonMoreActionsButton.MoreActionsButton=class extends i.Component{constructor(){super(...arguments),this._contextualMenuRef=null}get contextualMenuRef(){return this._contextualMenuRef}render(){return i.createElement(f.ContextualMenuButton,Object.assign({showTooltip:!0},this.props,{ref:e=>{this._contextualMenuRef=e},iconProps:{iconName:"More"},title:this.props.title||h.MoreActionsText}))}componentWillUnmount(){this._contextualMenuRef=null}}}(),function(e){function i(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}P=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),i(f),i(b),i(I)}("ComponentsContextualMenuButtonindex"),function(e){w=t.ComponentsDynamicDynamicLink={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsDynamicDynamicLink.DynamicLink=class extends i.Component{render(){let e=Object.assign({},this.props);return i.createElement(t.Observer.Observer,Object.assign({},e,{url:this.props.url}),i.createElement(s,{url:"",children:this.props.children}))}};class s extends i.Component{render(){let e=Object.assign({},this.props),t=null;return this.props.url&&(e.href=this.props.url),delete e.url,t=this.props.url?i.createElement("a",Object.assign({},e),this.props.children):i.createElement("span",Object.assign({},e),this.props.children)}}}(),function(e){_=t.ComponentsDynamicDynamicText={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsDynamicDynamicText.DynamicText=class extends i.Component{render(){let e=Object.assign({},this.props);return i.createElement(t.Observer.Observer,Object.assign({},e,{text:this.props.text}),i.createElement(s,{text:""}))}};class s extends i.Component{render(){const e=l.getNativeProps(this.props,l.htmlElementProperties);return i.createElement("span",Object.assign({},e),this.props.text)}}}(),function(e){function i(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}O=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),i(w),i(_)}("ComponentsDynamicindex"),function(e){y=t.ComponentsInfoIconInfoIcon={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsInfoIconInfoIcon.InfoIcon=class extends i.PureComponent{constructor(e){super(e),this._onClick=(()=>{this.setState({calloutOpened:!0})}),this._onKeyDown=(e=>{13!==e.keyCode&&32!==e.keyCode||this.setState({calloutOpened:!0})}),this._onDismiss=(()=>{this.setState({calloutOpened:!1})}),this._calloutTarget=i.createRef(),this.state={calloutOpened:!1}}render(){const{iconOrigin:e={horizontal:"center",vertical:"start"},iconProps:s,infoOrigin:o={horizontal:"center",vertical:"end"},infoText:n}=this.props,{calloutOpened:a}=this.state;return i.createElement("div",Object.assign({"aria-label":n},l.getNativeProps(this.props,l.divProperties),{ref:this._calloutTarget,onBlur:this._onDismiss,onClick:this._onClick,onKeyDown:this._onKeyDown,role:"button",tabIndex:0}),i.createElement(V.VssIcon,Object.assign({},s,{className:t.Util.css(s.className,"vss-info-icon")})),a&&i.createElement(t.Callout.Callout,{anchorElement:this._calloutTarget.current,anchorOrigin:e,calloutOrigin:o,contentClassName:"vss-info-callout",contentShadow:!0,onDismiss:this._onDismiss},this._renderCalloutContent()))}_renderCalloutContent(){const{infoText:e,onRenderContent:t}=this.props;return t?t():i.createElement("div",{className:"vss-info-text-container"},e)}}}(),function(e){C=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(y)}("ComponentsInfoIconindex"),function(e){N=t.ComponentsTooltipTooltip={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsTooltipTooltip.Tooltip=class extends i.Component{render(){const e=Object.assign({},this.props);return e.calloutProps||(e.calloutProps={isBeakVisible:!1}),e.calloutProps.gapSpace||(e.calloutProps.gapSpace=8),i.createElement(u.Tooltip,Object.assign({},e,{className:t.Util.css(e.className||e.calloutProps.className,"vss-Tooltip")}))}}}(),function(e){x=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(N)}("ComponentsTooltipindex"),function(e){U=t.ComponentsTooltipHostTooltipHost={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsTooltipHostTooltipHost.TooltipHost=class extends i.Component{render(){const e=Object.assign({},this.props);return e.calloutProps||(e.calloutProps={isBeakVisible:!1}),e.calloutProps.gapSpace||(e.calloutProps.gapSpace=8),i.createElement(u.TooltipHost,Object.assign({},e,{className:t.Util.css(e.className||e.calloutProps.className,"vss-Tooltip")}))}}}(),function(e){E=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(U)}("ComponentsTooltipHostindex"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(P)}("ContextualMenuButton"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(O)}("Dynamic"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(C)}("InfoIcon"),function(e){function i(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}M=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),i(x),i(E),t[e].TooltipDelay=u.TooltipDelay,t[e].TooltipOverflowMode=u.TooltipOverflowMode}("Tooltip"),function(e){T=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].VIEW_OPTIONS_CHANGE_EVENT="view-option-changed";t[e].ViewOptions=class{constructor(e={},t){this.observable=t||new c.Observable,this.currentState=Object.assign({},e.initialState)}subscribe(e,t){this.observable.subscribe(e,t)}unsubscribe(e,t){this.observable.unsubscribe(e,t)}getViewOptions(){return Object.assign({},this.currentState)}setViewOptions(e,t){const i=this.currentState;if(this.currentState=Object.assign({},e),!t){const t=Object.assign({},e);for(let s in i)e.hasOwnProperty(s)||(t[s]=null);this._triggerStateChange(t)}}clear(){this.setViewOptions({})}getViewOption(e){return this.currentState[e]}setViewOption(e,t){this.currentState[e]=t;const i={};i[e]=t,this._triggerStateChange(i)}_triggerStateChange(i){t.UtilitiesEvent.EventGroup.raise(this,t[e].VIEW_OPTIONS_CHANGE_EVENT,i),this.observable.notify(i,t[e].VIEW_OPTIONS_CHANGE_EVENT)}}}("UtilitiesViewOptionsViewOptions"),function(e){k=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(T)}("UtilitiesViewOptions"),function(e){var i;R=t.UtilitiesViewState={},Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.viewStateChanging="viewStateChanging",e.viewStateChanged="viewStateChanged"}(i=t.UtilitiesViewState.ViewStateEventNames||(t.UtilitiesViewState.ViewStateEventNames={}));t.UtilitiesViewState.ViewState=class{constructor(){this.observable=new c.Observable}subscribe(e,t){this.observable.subscribe(e,t)}unsubscribe(e,t){this.observable.unsubscribe(e,t)}notify(e,t,s,o,n){if(this.changingEvents){if(s&&n){let t=!1;for(let i of this.changingEvents)if(i.observable===s&&i.eventName===o){const o=s;o.mergeChangeEvents?i.eventValue=o.mergeChangeEvents(i.eventValue,e):i.eventValue=e,t=!0;break}t||this.changingEvents.push({observable:s,eventName:o,eventValue:e,notify:n})}}else{this.changingEvents=[],s&&n&&this.changingEvents.push({observable:s,eventName:o,eventValue:e,notify:n});const a={eventName:t,eventValue:e};this.observable.notify(a,i.viewStateChanging),this.observable.notify(e,t);for(let e of this.changingEvents)e.notify(e.eventValue,e.eventName);this.changingEvents=null,this.observable.notify(a,i.viewStateChanged)}}};class s extends c.Observable{constructor(e,t,i,s){super(),this.notifyViewStateDelegate=e,this.viewStateEventName=t,this.mergeEventsAsObjects=i}notify(e,t,i){this.shouldBypassViewState(e,t,i)?super.notify(e,t,i):this.notifyViewStateDelegate(e,this.viewStateEventName,this,t,super.notify.bind(this))}shouldBypassViewState(e,t,i){return!1}mergeChangeEvents(e,t){return t}}t.UtilitiesViewState.ViewStateObservable=s;t.UtilitiesViewState.ViewStateObservableValue=class extends s{constructor(e,t,i){super(e,t),this.v=i}get value(){return this.v}set value(e){e!==this.v&&(this.v=e,this.notify(e,"set"))}};t.UtilitiesViewState.ViewStateFilter=class extends t.UtilitiesFilter.Filter{constructor(e,t,i){super(i,new o(e,t))}};class o extends s{shouldBypassViewState(e,i,s){return i!==t.UtilitiesFilter.FILTER_CHANGE_EVENT}mergeChangeEvents(e,t){return Object.assign({},e,t)}}t.UtilitiesViewState.ViewStateOptions=class extends k.ViewOptions{constructor(e,t,i){super(i,new n(e,t))}};class n extends s{mergeChangeEvents(e,t){return Object.assign({},e,t)}}}(),function(e){F=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].NAVIGATION_POPPED_EVENT="navigationPopped";const i="updateNavigationState";t[e].ViewStateNavigation=class{constructor(i,s,o,n,a,r){this._onViewStateChanged=(e=>{let t;if(0===(t=void 0!==this.behaviorOverride?this.behaviorOverride:this.getUpdateBehavior(e)))return;const i=this.navHistoryService.getState();let s=!1;for(let e in this.navigationParameters){const t=this.navigationParameters[e].getValue();t?i[e]!==t&&(i[e]=t,s=!0):void 0!==i[e]&&(delete i[e],s=!0)}s&&(2===t?this.navHistoryService.pushState(i):this.navHistoryService.replaceState(i))}),this._onNavigate=(i=>{this.viewStateNotifyDelegate(null,t[e].NAVIGATION_POPPED_EVENT,this.viewState,t[e].NAVIGATION_POPPED_EVENT,()=>{i.newState&&this._updateFromNavigationState(i.newState.state)})}),this.pageContext=i,this.viewState=s,this.viewStateNotifyDelegate=o,this.navigationParameters=n,this.getUpdateBehavior=r,this.navHistoryService=i.getService("IVssHistoryService"),a&&this._updateFromNavigationState(this.navHistoryService.getState()),this.navHistoryService.subscribe(this._onNavigate),this.viewState.subscribe(this._onViewStateChanged,R.ViewStateEventNames.viewStateChanged)}dispose(){this.navHistoryService.unsubscribe(this._onNavigate),this.viewState.unsubscribe(this._onViewStateChanged,R.ViewStateEventNames.viewStateChanged)}updateNavigationState(e,t){this.behaviorOverride=e,this.viewStateNotifyDelegate(null,i,this.viewState,i,()=>{t()}),delete this.behaviorOverride}createObservableUrl(e,t=2,i){return new s(this.pageContext,this.viewState,e,t,i)}_updateFromNavigationState(e){for(let t in this.navigationParameters)this.navigationParameters[t].setValue(e[t])}updateFromNavigationState(e){const t=this.navigationParameters[e],i=this.navHistoryService.getState();t.getValue()!==i[e]&&t.setValue(i[e])}};class s extends c.ObservableValue{constructor(e,t,i,s,o){super(void 0),this.onViewStateChanged=(()=>{this.updateUrl()}),this.pageContext=e,this.viewState=t,this.state=i,this.mergeOptions=s,this.routeId=o,this.updateUrl(),this.viewState.subscribe(this.onViewStateChanged,R.ViewStateEventNames.viewStateChanged)}updateUrl(){let e;if(this.routeId){e=this.pageContext.getService("IVssLocationService").routeUrl(this.routeId,this.state)}else{e=this.pageContext.getService("IVssHistoryService").generateUrl(this.state,this.mergeOptions)}return this.value!==e&&(this.value=e),e}setState(e){this.state=e,this.updateUrl()}dispose(){this.viewState.unsubscribe(this.onViewStateChanged,R.ViewStateEventNames.viewStateChanged)}}}("NavigationViewStateNavigation"),function(e){var s;D=t.UtilitiesHubViewState={},Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.showFilterBar="showFilters",e.fullScreen="fullScreen"}(t.UtilitiesHubViewState.HubViewOptionKeys||(t.UtilitiesHubViewState.HubViewOptionKeys={})),function(e){e.pivotChanging="pivotChanging",e.filterChanging="filterChanging",e.viewOptionsChanging="viewOptionsChanging"}(s=t.UtilitiesHubViewState.HubViewStateEventNames||(t.UtilitiesHubViewState.HubViewStateEventNames={}));t.UtilitiesHubViewState.HubViewState=class extends R.ViewState{constructor(e={}){super(),this._viewOptions=new R.ViewStateOptions(this.notify.bind(this),s.viewOptionsChanging,e.viewOptions),this._filter=new R.ViewStateFilter(this.notify.bind(this),s.filterChanging,e.filterOptions),this._selectedPivot=new R.ViewStateObservableValue(this.notify.bind(this),s.pivotChanging,e.defaultPivot)}get selectedPivot(){return this._selectedPivot}get filter(){return this._filter}get viewOptions(){return this._viewOptions}canSwitchPivots(e){return!0}},t.UtilitiesHubViewState.HubViewStateContext=i.createContext({hubViewState:null})}(),function(e){A=t.NavigationVssViewState={},Object.defineProperty(t,"__esModule",{value:!0});t.NavigationVssViewState.VssViewState=class extends R.ViewState{constructor(e){super(),this._getUpdateBehavior=(e=>this.getUpdateBehavior(e)),this.pageContext=e,this.observableUrls=[],this.observableValueParams={}}setupNavigation(){this.navigation&&this.navigation.dispose(),this.navigation=new F.ViewStateNavigation(this.pageContext,this,this.notify.bind(this),this.getNavigationParameters(),!0,this._getUpdateBehavior)}dispose(){this.navigation&&(this.navigation.dispose(),delete this.navigation);for(let e of this.observableUrls)e.dispose();this.observableUrls=[]}updateNavigationState(e,t){this.navigation?this.navigation.updateNavigationState(e,t):t()}createObservableUrl(e,t,i){const s=this.navigation.createObservableUrl(e,t,i);return this.observableUrls.push(s),s}createObservableValue(e,t){return new R.ViewStateObservableValue(this.notify.bind(this),e,t)}createNavParamObservableValue(e,t,i,s,o,n){const a=this.createObservableValue(e,o);return this.observableValueParams[e]={key:t,observable:a,rawString:i,behavior:s,defaultValue:n},a}getNavigationParameters(){const e={};for(let t in this.observableValueParams){const i=this.observableValueParams[t];e[i.navParamName||i.key]=this.createObservableValueNavParam(i)}return e}getStringValueForNavParam(e,t,i){return null==e&&(e=i),t.serialize?t.serialize(e):null==e?void 0:t.rawString?e.toString():JSON.stringify(e)}getRawValueFromNavParamString(e,t){let i;if(e)if(t.deserialize)i=t.deserialize(e);else if(t.rawString)i=e;else try{i=JSON.parse(e)}catch(e){i=void 0}else i=void 0;return i}updateFromNavParamString(e,t,i,s){const o=this.getRawValueFromNavParamString(t,i);this.updateFromNavParamValue(e,o,s)}updateFromNavParamValue(e,t,i){null==t?null!=e&&i(void 0):e!==t&&i(t)}updateFromNavigationState(e){this.navigation&&this.navigation.updateFromNavigationState(e)}createObservableValueNavParam(e){return{getValue:()=>this.getStringValueForNavParam(e.observable.value,e,e.defaultValue),setValue:t=>{let i=e.observable.value;null==i&&(i=e.defaultValue),void 0===t&&void 0!==e.defaultValue?this.updateFromNavParamValue(i,e.defaultValue,t=>{e.observable.value=t}):this.updateFromNavParamString(i,t,e,t=>{void 0===t&&(t=e.defaultValue),e.observable.value=t})}}}getUpdateBehavior(e){let t=0,i=this.observableValueParams[e.eventName];return i&&(t=i.behavior),t}}}(),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].DEFAULT_PIVOT_PARAM_NAME="view";let i=[{key:D.HubViewOptionKeys.showFilterBar,serialize:e=>e?"true":void 0},{key:D.HubViewOptionKeys.fullScreen,serialize:e=>e?"true":void 0}];t[e].VssHubViewState=class extends A.VssViewState{constructor(s,o={},n=!0){super(s),this._onViewOptionsChanged=(e=>{D.HubViewOptionKeys.fullScreen in e&&this._setFullScreenMode(!0===e[D.HubViewOptionKeys.fullScreen])}),this._viewOptions=new R.ViewStateOptions(this.notify.bind(this),D.HubViewStateEventNames.viewOptionsChanging,o.viewOptions),this._filter=new R.ViewStateFilter(this.notify.bind(this),D.HubViewStateEventNames.filterChanging,o.filterOptions),this.viewOptionParams={},this.chromeless=document.body.classList.contains("chromeless");for(let e of i)this.viewOptionParams[e.key]=e;if(o.viewOptionNavigationParameters)for(let e of o.viewOptionNavigationParameters)0===e.behavior?delete this.viewOptionParams[e.key]:this.viewOptionParams[e.key]=e;if(this.filterParams={},o.filterNavigationParameters)for(let e of o.filterNavigationParameters)this.filterParams[e.key]=e;this.pivotNavigationBehavior=void 0===o.pivotNavigationBehavior?2:o.pivotNavigationBehavior,this._pivotParamName=void 0===o.pivotNavigationParamName?t[e].DEFAULT_PIVOT_PARAM_NAME:o.pivotNavigationParamName,this._pivotParamName?this._selectedPivot=this.createNavParamObservableValue(D.HubViewStateEventNames.pivotChanging,this._pivotParamName,!0,this.pivotNavigationBehavior,o.defaultPivot,o.defaultPivot):this._selectedPivot=new R.ViewStateObservableValue(this.notify.bind(this),D.HubViewStateEventNames.pivotChanging,o.defaultPivot),n&&this.setupNavigation(),this.viewOptions.subscribe(this._onViewOptionsChanged,k.VIEW_OPTIONS_CHANGE_EVENT)}get selectedPivot(){return this._selectedPivot}get filter(){return this._filter}get viewOptions(){return this._viewOptions}canSwitchPivots(e){return!0}setupNavigation(){super.setupNavigation(),this._setFullScreenMode(!0===this.viewOptions.getViewOption(D.HubViewOptionKeys.fullScreen))}dispose(){super.dispose(),this.viewOptions.unsubscribe(this._onViewOptionsChanged,k.VIEW_OPTIONS_CHANGE_EVENT)}getNavigationParameters(){const e=super.getNavigationParameters();for(let t in this.viewOptionParams){const i=this.viewOptionParams[t];e[i.navParamName||i.key]=this.createViewOptionNavParam(i)}for(let t in this.filterParams){const i=this.filterParams[t],s=i.navParamName||i.key;e[s]=this.createFilterNavValueParam(i),e["op."+s]=this.createFilterNavOperatorParam(i)}return e}createViewOptionNavParam(e){return{getValue:()=>this.getStringValueForNavParam(this.viewOptions.getViewOption(e.key),e),setValue:t=>{const i=this.viewOptions.getViewOption(e.key);this.updateFromNavParamString(i,t,e,t=>{this.viewOptions.setViewOption(e.key,t)})}}}createFilterNavValueParam(e){return{getValue:()=>this.getStringValueForNavParam(this.filter.getFilterItemValue(e.key),e),setValue:t=>{const i=this.filter.getFilterItemValue(e.key);this.updateFromNavParamString(i,t,e,t=>{const i=this.filter.getFilterItemState(e.key);this.filter.setFilterItemState(e.key,{value:t,operator:i&&i.operator})})}}}createFilterNavOperatorParam(e){return{getValue:()=>{const t=this.filter.getFilterItemState(e.key);return t&&"or"===t.operator?"or":void 0},setValue:t=>{const i=this.filter.getFilterItemState(e.key);"or"===t?i&&"or"===i.operator||this.filter.setFilterItemState(e.key,{value:i&&i.value,operator:"or"}):i&&"or"===i.operator&&this.filter.setFilterItemState(e.key,{value:i.value,operator:"and"})}}}_setFullScreenMode(e){e||this.chromeless?document.body&&document.body.classList.add("full-screen-mode"):document.body&&document.body.classList.remove("full-screen-mode")}getUpdateBehavior(e){let t=super.getUpdateBehavior(e);switch(e.eventName){case D.HubViewStateEventNames.pivotChanging:t=this.pivotNavigationBehavior;break;case D.HubViewStateEventNames.viewOptionsChanging:for(let i in e.eventValue){const e=this.viewOptionParams[i];if(e&&0!==e.behavior&&(t=e.behavior,1===e.behavior))break}break;case D.HubViewStateEventNames.filterChanging:for(let i in e.eventValue){const e=this.filterParams[i];if(e&&0!==e.behavior&&(t=e.behavior,1===e.behavior))break}}return t}}}("NavigationVssHubViewState"),t.RegistrationVssComponentRegistration={},Object.defineProperty(t,"__esModule",{value:!0}),p.VssComponent.register("contextualMenu",d.VssContextualMenu),p.VssComponent.register("callout",t.Callout.Callout),p.VssComponent.register("tooltipHost",M.TooltipHost),p.VssComponent.register("vssIcon",V.VssIcon),p.VssComponent.register("vssPersona",t.VssPersona.VssPersona),function(e){t.UtilitiesChildrenUtils={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilitiesChildrenUtils.childrenOfType=function(e,t){let s=[];return i.Children.map(e||[],(e,i)=>{"object"==typeof e&&e.type===t&&s.push({index:i,item:e})}),s}}(),function(e){t.UtilitiesInternal={},Object.defineProperty(t,"__esModule",{value:!0}),t.UtilitiesInternal.arrayEquals=function(e,t,i=((e,t)=>e===t)){if(!e||!t)return!1;if(e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(!i(e[s],t[s]))return!1;return!0},t.UtilitiesInternal.closest=function(e,t){if(e&&e.closest)return e.closest(t);for(;e&&!(e.matches||e.msMatchesSelector).call(e,t);)e=e.parentElement;return e}}(),function(e){B=t[e]={},Object.defineProperty(t,"__esModule",{value:!0});t[e].ContributedItemWithIdArray=class extends c.ObservableArray{constructor(e,t,i){super([]),e.loadItems((e,s)=>{const o={};s=s||[],this.value.forEach(e=>{const t=i(e);-1===s.indexOf(t)&&(o[t]=e)}),(e||[]).map(t).forEach(e=>{o[i(e)]=e});let n=[];Object.keys(o).forEach(e=>{n.push(o[e])}),this.value=n})}};t[e].ContributedItemArray=class extends c.ObservableArray{constructor(e,t){super([]),e.loadItems(e=>{this.value=(e||[]).map(t)})}};t[e].MutatedItemProvider=class{constructor(e,t){this.provider=e,this.mutator=t}loadItems(e){this.provider.loadItems(t=>e((t||[]).map(this.mutator)))}};t[e].PromiseWrappingItemProvider=class{constructor(e){this.provider=e}loadItems(e){e&&e([this.getItems()])}getItems(){let e;return this.provider.loadItems(t=>{e=new Promise(e=>e(t))}),e}};t[e].ObservableArrayWrappingItemProvider=class{constructor(e){this.provider=e,this.loaded=!1,this.observableArray=new c.ObservableArray([])}loadItems(e){e&&e([this.getItems()])}getItems(){return this.loaded||this.provider.loadItems(e=>{this.loaded=!0,this.observableArray.push(...e)}),this.observableArray}}}("UtilitiesItemContributionItemContribution"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(i){for(var s in i)t[e].hasOwnProperty(s)||(t[e][s]=i[s])}(B)}("UtilitiesItemContribution")},["VSS.Resources.VSSUI","Components/VssContextualMenu/VssContextualMenu","Components/VssContextualMenu/index","VssContextualMenu","Components/VssIcon/VssIcon","Components/VssIcon/index","VssIcon","Components/ContextualMenuButton/ContextualMenuButton","Components/ContextualMenuButton/DropdownButton","Components/ContextualMenuButton/MoreActionsButton","Components/ContextualMenuButton/index","Components/Dynamic/DynamicLink","Components/Dynamic/DynamicText","Components/Dynamic/index","Components/InfoIcon/InfoIcon","Components/InfoIcon/index","Components/Tooltip/Tooltip","Components/Tooltip/index","Components/TooltipHost/TooltipHost","Components/TooltipHost/index","ContextualMenuButton","Dynamic","InfoIcon","Tooltip","Utilities/ViewOptions/ViewOptions","Utilities/ViewOptions","Utilities/ViewState","Navigation/ViewStateNavigation","Utilities/HubViewState","Navigation/VssViewState","Navigation/VssHubViewState","Registration/VssComponentRegistration","Utilities/ChildrenUtils","Utilities/Internal","Utilities/ItemContribution/ItemContribution","Utilities/ItemContribution"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-content"}}));