"use strict";define("VSSUI",["require","exports","OfficeFabric/DetailsList","OfficeFabric/Utilities","react","OfficeFabric/FocusZone","OfficeFabric/Selection"],function(e,t,s,i,n,o,l){var r,a,c,d,p,m,h,u,I;!function(e){r=t.ComponentsVssDetailsListVssDetailsList={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsVssDetailsListVssDetailsList.VssDetailsList=class extends i.BaseComponent{constructor(e){super(e),this.standardPresentationStyle=127,this._onItemContextMenu=((e,s,i)=>{const n=i;if(n){const e=n.target;if(e&&("A"===e.nodeName||t.UtilitiesInternal.closest(e,"A")))return!0}if(this.props.shouldDisplayActions&&!this.props.shouldDisplayActions(e))return!0;if(!n)return this.setState({activatedItem:e,target:void 0});let o=null;if(0===n.button||!(n.clientX>0&&n.clientY>0)){const e=n.target,s=t.UtilitiesInternal.closest(e,'[role="row"]');o=s?s.querySelector(`.${t.ComponentsContextualMenuButtonContextualMenuButton.ContextualMenuButton.ButtonContainerClassName}`):null}this.setState({activatedItem:e,target:o||n})}),this._onDismiss=(()=>{this.setState({activatedItem:void 0,target:void 0})}),this._onEllipsisClick=(e=>{const t=Number(e.currentTarget.dataset.index),i=this.props.selectionMode===s.SelectionMode.multiple,n=this.state.selection;n.setChangeEvents(!1);const o=e.ctrlKey||e.metaKey;if(i&&e.shiftKey){const e=!o;n.selectToIndex(t,e)}else i?(!n.isIndexSelected(t)&&!o&&n.setAllSelected(!1),n.setIndexSelected(t,!0,!0)):(n.setAllSelected(!1),n.setIndexSelected(t,!0,!0));n.setChangeEvents(!0)}),this.state={}}componentWillMount(){const e=this._buildClassNames(this.props),t=this._buildColumns(this.props),s=this._buildSelection(this.props);this.overrideSelectedIndex=!1,this.setState({classNames:e,columns:t,selection:s})}componentDidMount(){this.overrideSelectedIndex=!0}componentWillReceiveProps(e){const t={};this.props.className===e.className&&this.props.presentationStyles===e.presentationStyles&&this.props.usePresentationStyles===e.usePresentationStyles&&this.props.rowStyle===e.rowStyle||(t.classNames=this._buildClassNames(e)),this.props.columns===e.columns&&this.props.actionsColumnKey===e.actionsColumnKey||(t.columns=this._buildColumns(e)),this.props.selection!==e.selection&&(t.selection=this._buildSelection(e)),this.setState(t)}render(){const{checkboxVisibility:e=s.CheckboxVisibility.hidden}=this.props,{classNames:t,columns:i}=this.state,o=Object.assign({},this.props),l=this._hasActions(this.props);o.className=t,o.checkboxVisibility=e,o.checkboxCellClassName="vss-DetailsList--cellCheck",o.columns=i,l&&(o.onItemContextMenu=this._onItemContextMenu);const r=n.createElement(s.DetailsList,Object.assign({},o,{initialFocusedIndex:this.overrideSelectedIndex?void 0:o.initialFocusedIndex,selection:this.state.selection,componentRef:this._resolveRef("detailsList")}));return l?n.createElement("div",{className:"vss-DetailsList--contextmenu-wrapper"},r,this._getContextMenu()):r}_createActionsColumn(e){const s=Object.assign({},e);return s.onRender=((s,i,o)=>{let l=null;e.onRender?l=e.onRender(s,i,o):this.props.onRenderItemColumn&&(l=this.props.onRenderItemColumn(s,i,o));let r=!0;return this.props.shouldDisplayActions&&(r=this.props.shouldDisplayActions(s)),r?n.createElement("div",{className:"actions-column-wrapper"},n.createElement("div",{className:"original-content"},l),n.createElement(t.ContextualMenuButton.MoreActionsButton,{allocateSpaceWhileHidden:this.props.allocateSpaceForActionsButtonWhileHidden,className:"vss-DetailsList--contextual-menu-button",getItems:this.props.getMenuItems&&(()=>this.props.getMenuItems(s)),getItemProviders:this.props.getMenuItemProviders&&(()=>this.props.getMenuItemProviders(s)),onDismiss:this._onDismiss,dataIndex:i,onClick:this._onEllipsisClick})):l}),s}_hasActions(e){return!(!e.actionsColumnKey||!e.getMenuItems&&!e.getMenuItemProviders)}_buildSelection(e){return e.selection||new s.Selection({getKey:e.getKey})}_buildColumns(e){const{actionsColumnKey:t,columns:s}=e;if(this._hasActions(e)&&s){const e=[];for(let i of s)i.key===t&&(i=this._createActionsColumn(i)),e.push(i);return e}return s}_buildClassNames(e){const{usePresentationStyles:s,className:i,rowStyle:n,hideGroupExpansion:o}=e;let{presentationStyles:l}=e,r="";if(s||l){void 0===l&&(l=this.standardPresentationStyle);const e=["vss-DetailsList--layout"];i&&e.push(i),1&l&&e.push("hideActionsButton"),2&l&&e.push("singleLine"),4&l&&e.push("flexCellLayout"),8&l&&e.push("paddingInCells"),16&l&&e.push("colors"),32&l&&e.push("linkStyles"),64&l&&e.push("headerRowStyles"),r=e.join(" ")}else r=t.Util.css("vss-DetailsList",i,1===n&&"vss-DetailsList--twoLine");return r=t.Util.css(r,o&&"noGroupExpand")}_getContextMenu(){const{activatedItem:e,target:s}=this.state;if(!e)return;const{getMenuItems:i,getMenuItemProviders:o}=this.props,l=i?i(e):void 0,r=o?o(e):void 0;return l||r?n.createElement(t.VssContextualMenu.VssContextualMenu,{items:l,providers:r,onDismiss:this._onDismiss,shouldFocusOnMount:!0,target:s,gapSpace:0}):void 0}}}(),function(e){a=t.ComponentsVssDetailsListVssDetailsListGroupHeader={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsVssDetailsListVssDetailsListGroupHeader.VssDetailsListGroupHeader=class extends i.BaseComponent{render(){const{text:e,textCssClassName:s,onRenderContent:i}=this.props;return n.createElement("div",{className:"vss-DetailsList--groupHeader","data-is-focusable":"true"},n.createElement(o.FocusZone,{direction:o.FocusZoneDirection.horizontal},i?i():n.createElement("div",{className:t.Util.css("vss-DetailsList--groupHeaderText",s)},e)))}}}(),function(e){c=t.ComponentsVssDetailsListVssDetailsListTitleCell={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsVssDetailsListVssDetailsListTitleCell.VssDetailsListTitleCell=class extends i.BaseComponent{render(){const{secondaryText:e,onRenderSecondaryText:s,ariaLabel:i,iconProps:o}=this.props;return e||s?n.createElement("div",{className:t.Util.css("vss-DetailsList--titleCellTwoLine",!o&&"noIcon"),"aria-label":i},this._renderIcon(),n.createElement("div",{className:"vss-DetailsList--titleCellTwoLineText"},this._renderPrimaryText(),this._renderSecondaryText()),this._renderIndicators()):n.createElement("div",{className:"vss-DetailsList--titleCellOneLine","aria-label":i},this._renderIcon(),this._renderPrimaryText(),this._renderIndicators())}_renderPrimaryText(){const{primaryText:e,primaryAction:s,primaryTarget:i,disabled:o,onRenderPrimaryText:l}=this.props;let{primaryActionRole:r}=this.props;const a=l?l():s?"function"==typeof s?n.createElement(t.Link.Link,{className:t.Util.css("vss-DetailsList--titleCellText",o&&"disabled"),role:r||"button",href:"#",onClick:s},e):n.createElement(t.Link.Link,{className:t.Util.css("vss-DetailsList--titleCellText",o&&"disabled"),role:r||"link",href:s,target:i},e):n.createElement("span",{className:t.Util.css("vss-DetailsList--titleCellText",o&&"disabled")},e);return n.createElement("div",{className:"vss-DetailsList--titleCellPrimary"},a)}_renderSecondaryText(){const{secondaryText:e,disabled:s,onRenderSecondaryText:i}=this.props,o=i?i():n.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:e},n.createElement("div",{className:"flex flex-grow text-ellipsis"},n.createElement("span",{className:t.Util.css("vss-DetailsList--titleCellText",s&&"disabled")},e)));return o?n.createElement("div",{className:"vss-DetailsList--titleCellSecondary"},o):null}_renderIcon(){const{iconProps:e,disabled:s}=this.props;return e?n.createElement(t.VssIcon.VssIcon,Object.assign({},e,{className:t.Util.css("vss-DetailsList--titleCellIcon",e.className,s&&"disabled",3===e.iconType&&"vss-DetailsList--titleCellIcon--image")})):null}_renderIndicators(){const e=this.props.indicators?this.props.indicators.map(e=>e.getItemIndicator()):[];return e&&e.length>0?n.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:e}):null}}}(),function(e){function s(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}d=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),s(r),s(a),s(c)}("ComponentsVssDetailsListindex"),function(e){p=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}(d)}("VssDetailsList"),function(e){m=t.ComponentsTreeTreeList={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsTreeTreeList.TreeList=class extends i.BaseComponent{constructor(e){super(e),this.newlySelectedItem=void 0,this.onRenderRow=((e,t)=>{const s=e.item;return s.isExpandable?n.createElement(r,{expanded:s.isExpanded,treeListItem:s,rowProps:e,collapse:this.onCollapse,expand:this.onExpand,onKeyDown:this.props.onRowKeyDown}):t(e)}),this.onCollapse=(e=>!!e.isExpanded&&(this.props.onItemToggled(e),!0)),this.onExpand=(e=>!e.isExpanded&&(this.props.onItemToggled(e),!0)),this.onSelectionChanged=(()=>{const e=this.selection.getSelection();let t=[];if(e&&e.length>0){for(const s of e){const e=s;t.push(e.treeItem.item),this.newlySelectedItem=e}this.itemsToSelect=void 0}this.props.onSelectedItemsChanged&&this.props.onSelectedItemsChanged(t)}),this.onItemToggled=((e,t)=>{e.isExpanded?t?this.props.onItemToggled(e):this.canCollapse(e)?this.props.onItemToggled(e):this.newlySelectedItem=void 0:this.props.onItemToggled(e)}),this.canCollapse=(e=>this.selection.mode===l.SelectionMode.none||this.newlySelectedItem!==e),this.selection=new l.Selection({onSelectionChanged:this.onSelectionChanged,selectionMode:e.selectionMode,getKey:e=>e.treeItem.id})}setSelectedItemsById(e){this.selection.setAllSelected(!1),this.itemsToSelect=e,this.setSelection()}render(){const{className:e,treeListItems:s,primaryTreeColumnKey:i,actionsColumnKey:l,onPrimaryCellClick:r,getMenuItemProviders:a,getMenuItems:c,allocateSpaceForActionsButtonWhileHidden:d,isHeaderVisible:m,initialFocusedIndex:h,onItemInvoked:u,onRowDidMount:I,checkboxVisibility:C}=this.props,v=[...this.props.columns];let L=0;if(void 0!==i)for(let e=0;e<v.length;e++)if(v[e].key===i){L=e;break}const g=v[L].onRender;return v[L]=Object.assign({},v[L],{onRender:(e,t,s)=>n.createElement(o,{onItemToggled:this.onItemToggled,treeListItem:e,index:t,column:s,onColumnRender:g,indentPaddingInPixels:20,onClick:r})}),n.createElement("div",{role:"treegrid"},n.createElement(p.VssDetailsList,{className:t.Util.css("tree-list",e),isHeaderVisible:m,items:s,initialFocusedIndex:h,columns:v,actionsColumnKey:l,getMenuItems:c,allocateSpaceForActionsButtonWhileHidden:d,getMenuItemProviders:a,onRenderRow:this.onRenderRow,usePresentationStyles:!0,setKey:"0",selection:this.selection,selectionPreservedOnEmptyClick:!0,onRowDidMount:I,onItemInvoked:u,checkboxVisibility:C}))}componentDidUpdate(){this.setSelection()}setSelection(){if(this.itemsToSelect){let e=[];for(let t of this.itemsToSelect)this.selection.setKeySelected(t,!0,!1),this.selection.isKeySelected(t)||e.push(t);0===e.length&&(e=void 0),this.itemsToSelect=e}}};class o extends n.Component{constructor(){super(...arguments),this.onExpandCollapseButtonClicked=(e=>{e.stopPropagation(),this.props.onItemToggled(this.props.treeListItem,!0)}),this.onCellClicked=(e=>{this.props.onClick?this.props.onClick(e,this.props.treeListItem.treeItem.item):this.props.onItemToggled(this.props.treeListItem,!1)})}render(){const{treeListItem:e}=this.props,s=this.props.indentPaddingInPixels*e.indentLevel,i=e.isLoading&&n.createElement(t.Spinner.Spinner,{size:"xsmall",className:"tree-list-spinner"}),o=n.createElement(t.Icon.Icon,{className:t.Util.css("tree-chevron",!e.isExpandable&&"invisible"),iconName:e.isExpanded?"ChevronDownSmall":"ChevronRightSmall",onClick:this.onExpandCollapseButtonClicked});return n.createElement("div",{className:"tree-column-wrapper",onClick:this.onCellClicked,style:{paddingLeft:`${s}px`}},i||o,this.props.onColumnRender(this.props.treeListItem,this.props.index,this.props.column))}}class r extends n.Component{constructor(){super(...arguments),this.onKeyDown=(e=>{39===e.which?this.props.expand(this.props.treeListItem)&&(e.preventDefault(),e.stopPropagation()):37===e.which?null!==this.rowComponent&&null!==this.detailsElement&&document.activeElement!=this.detailsElement?this.rowComponent.focus():this.props.collapse(this.props.treeListItem)&&(e.preventDefault(),e.stopPropagation()):this.props.onKeyDown&&this.props.onKeyDown(e,this.props.rowProps.item.treeItem.item)})}render(){return n.createElement("div",{onKeyDown:this.onKeyDown,ref:e=>{this.rowElement=e}},n.createElement(s.DetailsRow,Object.assign({},this.props.rowProps,{"aria-expanded":this.props.expanded,ref:e=>{this.rowComponent=e}})))}componentDidMount(){this.detailsElement=null,null!==this.rowElement&&(this.detailsElement=this.rowElement.querySelector("[tabIndex='0']")||this.rowElement.children[0])}}}(),function(e){h=t.ComponentsTreeTree={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsTreeTree.Tree=class extends i.BaseComponent{constructor(e){super(e),this.onItemToggled=(e=>{if(e.isExpandable){e.isExpanded=!e.isExpanded;const{treeItemProvider:t}=this.props;if(e.isExpanded)this.buildTree(t,e.treeItem.item),this.forceUpdate();else{const t=this.state.treeListItems,s=[];let i=void 0;for(let n of t)n===e?(i=e.indentLevel,s.push(n)):(void 0===i||i>=n.indentLevel)&&(s.push(n),i=void 0);e.isLoading=!1,this.setState({treeListItems:s})}}}),this.childrenMap={};const t=[...this.props.columns],s=this.buildColumns(t);this.state={treeListItems:[],treeListItemColumns:s},this.buildTree(e.treeItemProvider,void 0)}setSelectedItemsById(e){this.treeList&&this.treeList.setSelectedItemsById(e)}componentWillReceiveProps(e){if(this.props.columns!==e.columns){const t=[...e.columns],s=this.buildColumns(t);this.setState({treeListItemColumns:s})}this.props.treeItemProvider!==e.treeItemProvider&&(this.childrenMap={},this.buildTree(e.treeItemProvider,void 0))}render(){const{treeListItems:e,treeListItemColumns:t}=this.state;return n.createElement(m.TreeList,Object.assign({},this.props,{componentRef:e=>this.treeList=e,treeListItems:e,columns:t,onItemToggled:this.onItemToggled}))}buildColumns(e){return e.map(e=>Object.assign({},e,{onRender:t=>e.onRender(t.treeItem)}))}buildTree(e,t){const s=Promise.resolve(e.getChildren(t)),i=void 0!==t&&e.getTreeListItem(t);i&&(i.isLoading=!0),s.then(s=>{const n=[],o=void 0!==t?i.indentLevel+1:0;for(let t of s)n.push(this.addTreeItems(e,t,o));Promise.all(n).then(e=>{const s=[].concat.apply([],e);let n=[];if(void 0===t)n=s;else{const e=this.state.treeListItems;for(let i of e)n.push(i),t===i.treeItem.item&&(n=n.concat(s))}(!i||i&&i.isExpanded&&i.isLoading)&&(i&&(i.isLoading=!1),this.setState({treeListItems:n}))})})}addTreeItems(e,t,s){const i=[],n=this.getOrCreateTreeListItem(e,t,s);if(i.push(n),n.isExpanded){const o=this.childrenMap[n.treeItem.id];return void 0!==o?(n.isLoading=!1,Promise.resolve(o)):Promise.resolve(e.getChildren(t)).then(t=>{const o=[];for(let i of t)o.push(this.addTreeItems(e,i,s+1));return Promise.all(o).then(e=>{const t=[].concat.apply(i,e);return this.childrenMap[n.treeItem.id]=t,t})})}return Promise.resolve(i)}getOrCreateTreeListItem(e,t,s){let i=e.getTreeListItem(t);if(!i){const n=e.getTreeItem(t);i={treeItem:n,indentLevel:s,isExpandable:n.isExpandable,isExpanded:!!n.defaultIsExpanded,isLoading:!1},e.setTreeListItem(t,i)}return i}}}(),function(e){u=t.ComponentsTreeTreeItemProvider={},Object.defineProperty(t,"__esModule",{value:!0});t.ComponentsTreeTreeItemProvider.TreeItemProvider=class{constructor(){this.treeListItemMap=new Map}setTreeListItem(e,t){this.treeListItemMap.set(e,t)}getTreeListItem(e){return this.treeListItemMap.get(e)}}}(),function(e){function s(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}I=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),s(h),s(u),s(m)}("ComponentsTreeindex"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}(I)}("Tree")},["Components/VssDetailsList/VssDetailsList","Components/VssDetailsList/VssDetailsListGroupHeader","Components/VssDetailsList/VssDetailsListTitleCell","Components/VssDetailsList/index","VssDetailsList","Components/Tree/TreeList","Components/Tree/Tree","Components/Tree/TreeItemProvider","Components/Tree/index","Tree"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-detailslist-content"}}));