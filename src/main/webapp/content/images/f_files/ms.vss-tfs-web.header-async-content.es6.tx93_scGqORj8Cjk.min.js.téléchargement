"use strict";define("Tfs/Header/Components",["require","exports","react","VSS/Features/PlatformUI/ContributedBreadcrumb","VSS/Platform/Layout","VSSUI/Breadcrumb","VSSUI/Observer","VSSUI/Spinner","VSSUI/Callout","VSS/Platform/Context","VSS/Platform/FPS","VSS/Legacy/Legacy"],function(e,t,o,s,r,n,a,i,c,d,l,u){var h;h=t.Resources={},Object.defineProperty(t,"__esModule",{value:!0}),t.Resources.KeyboardShortcuts="Keyboard shortcuts",t.Resources.Loading="Loading...",t.Resources.MoreApplications="More",t.Resources.Marketplace="Marketplace",t.Resources.AppSwitcherHomeLink="Home",function(e){t.ComponentsHeaderBreadcrumbHeaderBreadcrumb={},Object.defineProperty(t,"__esModule",{value:!0});class i extends r.VssComponent{constructor(e,t){super(e,t),this.onSearchExpanded=(()=>{this.setState({isVisible:!1})}),this.onSearchCollapsed=(()=>{this.setState({isVisible:!0})}),this.onExtraContentSelectionChanged=(e=>{this.setState({extraContentSelected:e})}),this.onFocusLost=(()=>{this.setState({extraContentSelected:!1})}),this.onFocus=(()=>{this.setState({extraContentSelected:!0})}),this._breadcrumbItemProvider=s.getBreadcrumbItems(this.context.pageContext,"ms.vss-tfs-web.vertical-header-breadcrumb"),this.state={isVisible:!0,breadcrumbItems:this._breadcrumbItemProvider,extraContentSelected:!1}}componentDidMount(){super.componentDidMount(),this.context.pageContext.getService("IVssPerformanceService").endScenario("tfs","WebPlatform.Frame",!1),this.addEventListener(window,"searchExpanded",this.onSearchExpanded),this.addEventListener(window,"searchCollapsed",this.onSearchCollapsed)}render(){if(!this.state.isVisible)return o.createElement("div",{className:"flex-grow"});const e=o.createElement(r.RegionComponent,{className:"flex-row",componentRegion:"headerBreadcrumb",childComponentProperties:{selected:this.state.extraContentSelected,onFocusLost:this.onFocusLost,onFocus:this.onFocus}});return o.createElement(a.Observer,{items:this.state.breadcrumbItems},o.createElement(n.Breadcrumb,{excludeTabStop:!0,className:"header-breadcrumb flex-grow",extraContent:e,onExtraContentSelectionChanged:this.onExtraContentSelectionChanged,extraContentSelected:this.state.extraContentSelected}))}}i.componentType="headerBreadcrumb",r.VssComponent.register(i.componentType,i)}(),function(e){t.ComponentsFpsLoadingFpsLoading={},Object.defineProperty(t,"__esModule",{value:!0});class s extends r.VssComponent{constructor(e){super(e),this.onFpsLoading=(e=>{this.lastLoadingEvent=e.detail,this.loadingDelayTimeout||(this.loadingDelayTimeout=this.setTimeout(()=>{this.setState({showLoadingIndicator:!0}),this.loadingDelayTimeout=0},s.preProgressDelay))}),this.onFpsCompleted=(e=>{this.lastLoadingEvent&&this.lastLoadingEvent.data===e.detail.data&&(this.lastLoadingEvent=void 0,this.loadingDelayTimeout&&this.clearTimeout(this.loadingDelayTimeout),this.state.showLoadingIndicator&&this.setState({showLoadingIndicator:!1}))}),this.state={}}render(){return this.state.showLoadingIndicator?o.createElement(c.Callout,{className:"fps-loading-content-layer",contentClassName:"fps-loading-content fontSizeM",contentLocation:1,contentJustification:1,contentOrientation:0,modal:!0},o.createElement(i.Spinner,{label:h.Loading,size:"large"})):null}componentDidMount(){super.componentDidMount(),this.addEventListener(document.body,"fpsLoading",this.onFpsLoading),this.addEventListener(document.body,"fpsCompleted",this.onFpsCompleted)}}s.preProgressDelay=500,t.ComponentsFpsLoadingFpsLoading.FpsLoadingComponent=s,r.VssComponent.register("fpsLoading",s)}(),function(e){t.HeaderBreadcrumbService={},Object.defineProperty(t,"__esModule",{value:!0});d.Services.add("header-breadcrumb-service",{serviceFactory:class extends d.VssObservableArrayService{constructor(){super(...arguments),this._onFPSItemClick=((e,t,o)=>{l.onClickFPS(this.pageContext,t,!0,e,{telemetrySource:"headerBreadcrumb",navigationId:o})})}_serviceStart(e){super._serviceStart(e),this.loadItems()}loadItems(){this._addCollectionItem(),this._addProjectItem(),this._addHubItems()}_addCollectionItem(){const e=this.pageContext.getService("IVssPageService").getData();e&&this.push({key:"Collection",text:e.hostName,href:e.hostPath,rank:10})}_addProjectItem(){const e=this.pageContext.getService("ITfsPageService").getData();if(e&&e.project){const t=e.project.url;this.push({key:"Project",text:e.project.name,href:t,onClick:e=>{this._onFPSItemClick(e,t||"","ms.vss-web.home-hub-group")},rank:20})}}_addHubItems(){const e=this.pageContext.getService("IVssNavigationService"),t=e.getDisplayedNavigation(),o=e.getNavigation(t[2]),s=e.getNavigation(t[3]);void 0!==o&&o.name&&this.push({key:"HubGroup",text:o.name,href:o.href,onClick:e=>{this._onFPSItemClick(e,o.href||"",o.id)},rank:30}),void 0!==s&&s.parentId&&s.name&&this.push({key:"Hub",text:s.name,href:s.href,onClick:e=>{this._onFPSItemClick(e,s.href||"",s.id)},rank:40})}}})}(),function(e){t.LegacyProfileDialogService={},Object.defineProperty(t,"__esModule",{value:!0});d.Services.add("LegacyProfileDialogService",{serviceFactory:class extends d.VssService{show(){this.pageContext.getService("IVssLayoutManager").renderCallout(e=>o.createElement(r.WrappedComponent,{wrappedType:"legacy",dependencies:["ms.vss-web.legacy-content"],wrappedProps:{componentType:"legacyProfileDialog",modules:["Admin/Scripts/LegacyProfileDialogComponent"]}},null))}}})}(),function(e){t.ShortcutMenuProvider={},Object.defineProperty(t,"__esModule",{value:!0});class s extends d.VssService{constructor(){super(...arguments),this.menuItems=[],this.getMenuItems=(()=>this.menuItems)}_serviceStart(e){super._serviceStart(e);const t=this.pageContext.getService("ITfsPageService").getData();this._shortcutsAvailable=!!t&&!!t.project,this._shortcutsAvailable&&this.menuItems.push({id:"tfsShortcutKeys",text:h.KeyboardShortcuts,rank:550,groupKey:"other-actions",onActivate:()=>{this.showDialog()}})}showDialog(){this.pageContext.getService("IVssLayoutManager").renderCallout(e=>{const t={modules:["VSS/Controls/KeyboardShortcuts"],wrappedType:"shortcutDialog",wrappedProps:{onDismiss:e}};return o.createElement(u.LegacyComponent,t)})}}t.ShortcutMenuProvider.ShortcutMenuProviderService=s,d.Services.add("ms.vss-tfs-web.shortcut-menu-provider",{serviceFactory:s})}()},["Resources","Components/HeaderBreadcrumb/HeaderBreadcrumb","Components/FpsLoading/FpsLoading","HeaderBreadcrumbService","LegacyProfileDialogService","ShortcutMenuProvider"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-tfs-web.header-async-content"}}));