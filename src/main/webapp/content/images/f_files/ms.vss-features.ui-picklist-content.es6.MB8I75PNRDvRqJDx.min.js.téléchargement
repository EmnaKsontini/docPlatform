"use strict";define("VSSUI",["require","exports","react","OfficeFabric/ComboBox","react-dom","OfficeFabric/FocusZone","OfficeFabric/List","OfficeFabric/Selection","VSS/Core/TimerManagement","OfficeFabric/TextField","OfficeFabric/Utilities","VSS/Core/Util/Object","VSS/Core/Util/Accessibility","OfficeFabric/Callout","VSS/Core/Util/String","VSS/Platform/Layout"],function(e,t,s,i,o,n,r,a,c,l,h,d,p,m,u,_){var g,S,I,f,v,k,L,y;g=t.ComponentsComboBoxComboBox={},Object.defineProperty(t,"__esModule",{value:!0}),t.ComponentsComboBoxComboBox.ComboBox=(e=>s.createElement(i.ComboBox,Object.assign({},e,{autoComplete:e.autoComplete?"on":"off",className:t.Util.css(e.className,"vss-ComboBox--container"),useComboBoxAsMenuWidth:!0}))),function(e){S=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}(g)}("ComponentsComboBoxindex"),function(e){t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}(S)}("ComboBox"),function(e){I=t.ComponentsPickListPickList={},Object.defineProperty(t,"__esModule",{value:!0});const i="select-all-item",m=8,u=250,_=250,g=1e3,S=200,f=340,v=32;class k extends s.Component{constructor(e){super(e),this._focusZone=s.createRef(),this._pivotFocusZone=s.createRef(),this._textField=s.createRef(),this._pickListElement=s.createRef(),this._operatorGroup=s.createRef(),this._groupLoadRequested={},this._searchText="",this._selectedPivot="",this._onPivotBarFocused=(()=>{this._pivotFocusZone.current&&this._pivotFocusZone.current.focus()}),this._onKeyDown=(e=>{if(9===e.which){const{onFocusLost:e}=this.props;e&&e()}else if(13===e.which&&this.props.selectExactMatchOnEnter&&this._searchText&&this.state.filteredItems){const e=this.state.filteredItems.filter(e=>this._isExactMatch(this._searchText,e));1===e.length&&this._onSelectionChanged([e[0].key])}}),this._onSearchTextChanged=(e=>{this._searchText=e,this._searchTextChangeDelegate(e)}),this._onClearInputClick=(()=>{this._searchText="",this._updateSearchText(),this._textField.current&&this._textField.current.focus()}),this._updateSearchText=(e=>{const{groups:s,onSearch:i}=this.props;let{isSearchInProgress:o}=this.state;const n=this._searchText;n&&i&&(window.setTimeout(()=>{this.state.isSearchInProgress&&p.announce(t.VSSResourcesVSSUI.Searching,!0,S)},g),o=!0,this._hideSearchingContentTimeout&&(window.clearTimeout(this._hideSearchingContentTimeout),this._hideSearchingContentTimeout=0),this._hideSearchingContent=!0,this._hideSearchingContentTimeout=window.setTimeout(()=>{this._hideSearchingContent=!1,this._searchingContentHidden&&this.forceUpdate()},u),this._getOnSearchPromise(n,e).then(e=>{if(n===this._searchText)if(e){o=!1;const{groupDictionary:t,itemsLoading:i,selectedKeys:r}=this.state,a=this._wrapItems(e,r,"search-results"),c=this._groupItems(a,t),l=this._filterByText(n,c),h=this._buildGroupedItems(n,o,e,l,s,r,i);this._announceSearchResults(l,o,i),this.setState({isSearchInProgress:o,filteredItems:h,searchResults:e,searchError:void 0},()=>this._rebuild(this.props))}else this.setState({isSearchInProgress:!1})},e=>{this.setState({isSearchInProgress:!1,searchError:e},()=>this._rebuild(this.props))}));const{groupDictionary:r,itemsLoading:a,selectedKeys:c}=this.state,l=this._filterByText(n,r),h=this._buildGroupedItems(n,o,[],l,s,c,a);this.scrollToIndex(0),this._announceSearchResults(l,o,a),this.setState({filteredItems:h,isSearchInProgress:o,searchResults:e?this.state.searchResults:[]},()=>this._rebuild(this.props))}),this._defaultFilterItemByText=((e,t)=>-1!==t.name.toLowerCase().indexOf(e.toLowerCase())),this._onSelectionChanged=((e,t)=>{let s=!1;if(this._isMounted){const{onSelectionChanged:o}=this.props,n=t||this.state.selectedOperatorKey;if(o){s=!0===o({selectedItems:e.filter(e=>e!==i&&!!this._itemDictionary[e]).map(e=>this._itemDictionary[e].data),selectedOperatorKey:n})}if(this._maintainsOwnState&&this._isMounted){this.state.filteredItems.map(t=>(t.isSelected=e.some(e=>e===t.key),t));this.setState({filteredItems:[...this.state.filteredItems],selectedKeys:e,selectedOperatorKey:n})}}return s}),this._onOperatorChanged=(e=>{this._onSelectionChanged(this.state.selectedKeys,e)}),this._onRenderCell=((e,t,i)=>{const{selectionMode:o}=this.props;if(e.isSeparator){if(e.isGroupHeader)return e.onRender?e.onRender():e.name?s.createElement("div",{role:"heading","aria-level":2,className:h.css("vss-PickList--groupHeader",{"first-group":0===t})},e.name):s.createElement("div",{className:"vss-PickList--groupSeparator"});if(e.isLoadingIndicator){const t=s.createElement("div",{className:"vss-PickList--loading"},s.createElement(b,{size:"medium",label:e.name}));return e.onRender?e.onRender(t):t}return e.messageLevel?s.createElement("div",{className:h.css("vss-PickList--message",2===e.messageLevel&&"is-error")},e.name):s.createElement("div",null,e.name)}const n=0===t||this.state.filteredItems[t-1].isSeparator,r=0===i.length?0:i.filter(e=>e<t).length,c=t-r,l=this.state.filteredItems.length-i.length;return o===a.SelectionMode.multiple?this._onRenderCellMultipleSelection(e,n,c,l):this._onRenderCellSingleSelection(e,n,c,l)}),this._onRenderCellSingleSelection=((e,t,i,o)=>{const n=this._getIndicators(e,this.props.indicators),r="function"==typeof e.disabled?e.disabled():e.disabled;return s.createElement(L,{ariaLabel:e.ariaLabel||e.name,ariaDescribedBy:this.props.itemAriaDescription&&this._ariaDescribedById,ref:e=>{0===i&&(this._firstRow=e)},dataSelectionKey:e.key,isSelected:e.isSelected,setSize:o,itemIndex:i,href:e.href,disabled:r,firstInGroup:t,onKeyboardEnter:()=>this._onSingleSelectionChanged(e.key,r)},s.createElement(y,{item:e,indicators:n,onSelectionChanged:()=>this._onSingleSelectionChanged(e.key,r),onRenderItemText:this.props.onRenderItemText}))}),this._onRenderCellMultipleSelection=((e,t,i,o)=>{const n=this._getIndicators(e,this.props.indicators),r="function"==typeof e.disabled?e.disabled():e.disabled;return s.createElement(L,{ariaLabel:e.ariaLabel||e.name,ariaDescribedBy:this.props.itemAriaDescription&&this._ariaDescribedById,ref:e=>{0===i&&(this._firstRow=e)},dataSelectionKey:e.key,spaceBarTriggersClick:!0,isSelected:e.isSelected,setSize:o,itemIndex:i,disabled:r,firstInGroup:t,onKeyboardEnter:()=>this._onMultipleSelectionChanged(e.key,!e.isSelected,r)},s.createElement(P,{item:e,indicators:n,onSelectionChanged:t=>this._onMultipleSelectionChanged(e.key,t,r)}))}),this._onActiveElementChanged=(e=>{if(this.props.selectionMode===a.SelectionMode.single&&this.props.selectOnFocus){const t=e.getAttribute("data-selection-key");t&&this._onSelectionChanged([t])}}),this._id=d.getId("PickList"),this._timerManagement=new c.TimerManagement,this._maintainsOwnState=!1,this._itemDictionary={},e.initiallySelectedItems&&e.selectedItems&&console.warn("Please only provide ONE of initiallySelectedItems OR selectedItems as props"),e.initiallySelectedItems&&(this._maintainsOwnState=!0),e.pivots&&e.pivots.length&&(this._selectedPivot=this._getInitialPivot(e)),this.state={isSearchInProgress:!1,initiallySelectedKeys:[],selectedKeys:[],filteredItems:[],searchResults:[],items:[],selectedOperatorKey:e.selectedOperatorKey,initiallySelectedOperatorKey:e.selectedOperatorKey},this._searchTextChangeDelegate=this._timerManagement.debounce(()=>this._updateSearchText(),_),this._ariaDescribedById=d.getId("picklist-described-by")}clearSelection(){this._onSelectionChanged([],this.state.initiallySelectedOperatorKey)}reset(){this._onSelectionChanged(this.state.initiallySelectedKeys,this.state.initiallySelectedOperatorKey)}selectAll(){this.props.selectionMode===a.SelectionMode.multiple&&this._onSelectionChanged(this._getKeysFromItems(this.state.items,this.state.items))}focus(e){if(!e&&this._pickListElement.current&&document.activeElement&&h.doesElementContainFocus(this._pickListElement.current))return!1;if(this._initialItemsLoaded||(this._focusOnInitialLoad=!0),this._textField.current)return this._textField.current.focus(),!0;if(this._focusZone.current){if(!this._operatorGroup.current)return this._firstRow?this._focusZone.current.focusElement(o.findDOMNode(this._firstRow)):this._focusZone.current.focus();this._operatorGroup.current.focus()}return!1}scrollToIndex(e){this._list&&this._list.scrollToIndex(e,()=>v)}scrollToSelected(){const{filteredItems:e}=this.state;if(e){const t=e.findIndex(e=>e.isSelected);t>0&&this.scrollToIndex(t)}}forceUpdate(){this._isMounted&&this._rebuild(this.props)}componentWillMount(){this._rebuild(this.props)}componentDidMount(){this._isMounted=!0;const{pivots:e,onSelectedPivotChanged:t}=this.props;t&&e&&e.length>0&&this._selectedPivot&&this._selectedPivot!==e[0].id&&t(this._selectedPivot)}componentWillUnmount(){this._itemsAnnouncer&&this._itemsAnnouncer.cancel(),this._timerManagement.clearAllTimers(),this._isMounted=!1}componentWillReceiveProps(e){const{selectedItems:t,selectedOperatorKey:s}=this.props,i=this._haveGroupsChanged(e);this._hasNewItems(e).then(o=>{if(this._isMounted)if(o||i)this._rebuild(e);else if(k._arrayEquals(t,e.selectedItems))s!==e.selectedOperatorKey&&this.setState({selectedOperatorKey:e.selectedOperatorKey});else{let t=this._getKeysFromItems(e.selectedItems,this.state.items);const s=this.state.filteredItems.map(e=>(e.isSelected=t.some(t=>t===e.key),e));for(let e in this._itemDictionary){this._itemDictionary[e].isSelected=t.some(t=>t===e)}this.setState({filteredItems:s,selectedKeys:t,selectedOperatorKey:e.selectedOperatorKey})}})}render(){const{getActions:e,isSearchable:i,searchBoxAriaLabel:o,onSearch:a,className:c,operators:d,minItemsForSearchBox:p=m,shouldVirtualize:u,onMouseLeave:_,onMouseEnter:g,itemAriaDescription:S,onRenderFooter:I}=this.props,{filteredItems:f,itemsLoading:v}=this.state,k=f?[...f]:[],L=this._getPivotBar(),y=this._getCurrentPivot();let P=e&&e(k)||[];const b=y&&y.searchTextPlaceholder||this.props.searchTextPlaceholder,w=y&&y.noItemsText||this.props.noItemsText;if(y&&y.getActions){P=(y.getActions(k)||[]).concat(P)}this._actionCount=P.length;const E=P.length>0&&P.map((e,t)=>s.createElement(x,{action:e,itemIndex:t,key:String(t),setSize:this._actionCount})),T=k&&k.length>1&&d&&s.createElement(C,{operators:d,selectedOperatorKey:this.state.selectedOperatorKey,onChange:this._onOperatorChanged,componentRef:e=>this._operatorGroup=e});let R=null;const O="function"==typeof u?()=>u(k):void 0;if(k.length){const e=L?"tabpanel":null,t=!!L||null,i="search-no-results"!==k[0].key&&"vss-PickList--hasItems",o=k.filter(e=>e.isGroupHeader).map(e=>k.indexOf(e));R=s.createElement("div",{className:h.css("vss-PickList--items",i),role:"listbox","data-is-scrollable":!0},s.createElement(r.List,{role:e,"aria-expanded":t,items:k,onRenderCell:(e,t)=>this._onRenderCell(e,t,o),onShouldVirtualize:O,componentRef:e=>this._list=e}))}else w&&0===k.length&&!v&&(R=s.createElement("div",{role:"alert","aria-live":"assertive",className:"vss-PickList--noItemsText"},w));const F={};return this.props.minWidth&&(F.minWidth=this.props.minWidth+"px"),this.props.maxWidth&&(F.maxWidth=this.props.maxWidth+"px"),this.props.width&&(k.length?F.width=this.props.width+"px":F.minWidth=this.props.width+"px"),this.props.maxHeight&&(F.maxHeight=`${this.props.maxHeight}px`),s.createElement("div",{className:h.css("vss-PickList",c),style:F,onKeyDown:this._onKeyDown,ref:this._pickListElement,id:t.Util.getSafeId(this.props.id||this._id),onMouseEnter:g,onMouseLeave:_},S&&s.createElement("div",{className:"vss-PickList--ariaDescription",id:t.Util.getSafeId(this._ariaDescribedById)},S),s.createElement(n.FocusZone,{className:"vss-PickList--focusContainer",ref:this._focusZone,isInnerZoneKeystroke:e=>39===e.which,direction:n.FocusZoneDirection.vertical,onActiveElementChanged:this._onActiveElementChanged,isCircularNavigation:!0},i&&(this.state.items.length>=p||a)&&s.createElement("div",{className:"vss-PickList--searchSection"},s.createElement("div",{className:"vss-PickList--searchTextContainer flex-row flex-center"},s.createElement(t.VssIcon.VssIcon,{className:"flex-noshrink vss-PickList--searchTextIcon",iconName:"search",iconType:0}),s.createElement(l.TextField,{className:"vss-PickList--searchTextField flex-grow",ref:this._textField,placeholder:b,value:this._searchText,ariaLabel:o||b,onChanged:this._onSearchTextChanged,onKeyDown:this._onKeyDown}))),T,L,R,E&&s.createElement("div",{className:"vss-PickList--actions",role:"listbox"},E),I&&I()))}_getPivotBar(){const e=[];if(!this.props.pivots||!this.props.limitSearchToPivot&&this._searchText||this.props.pivots.forEach(i=>{const o=this._selectedPivot===i.id;e.push(s.createElement(t.Button.Button,{id:i.id,key:i.id,className:h.css("vss-Picklist--pivotBar-button",o?"selected":""),onClick:this._onPivotClick.bind(this,i.id),ariaLabel:i.name,role:"tab","aria-selected":o,"aria-posinset":e.length,"aria-setsize":this.props.pivots.length},s.createElement("span",{className:"innerContainer"},s.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:i.name},s.createElement("span",{className:"text",style:{maxWidth:i.maxWidth||f}},i.name)))))}),e.length)return s.createElement("div",{className:"vss-PickList--pivotBar",role:"tablist","data-is-focusable":!0,onFocus:this._onPivotBarFocused},s.createElement(n.FocusZone,{direction:n.FocusZoneDirection.horizontal,ref:this._pivotFocusZone},e))}_onPivotClick(e,t){t.preventDefault(),this._updateSelectedPivot(e)}_updateSelectedPivot(e){this._selectedPivot!==e&&(this._selectedPivot=e,this.props.onSelectedPivotChanged&&this.props.onSelectedPivotChanged(e),this.props.limitSearchToPivot&&this._searchText&&this._updateSearchText(),this.scrollToIndex(0),this.forceUpdate())}_getInitialPivot({selectedItems:e,initiallySelectedItems:t,getListItem:s,groups:i,pivots:o}){const n=e&&e[0]||t&&t[0];if(n&&s){const{groupKey:e}=s(n);if(e){const t=i.filter(t=>t.key===e)[0];if(t&&t.pivotId)return t.pivotId}}return o[0].id}_getCurrentPivot(){return this.props.pivots&&this.props.pivots.filter(e=>e.id===this._selectedPivot)[0]}_rebuild(e){if(this.props.items!==e.items&&this._itemsAnnouncer&&(this._itemsAnnouncer.cancel(),this._itemsAnnouncer=null),this._isThenable(e.items)){if(this._buildFromItems(e,this.state.items,!0),e.items.then(t=>{this.props.items===e.items&&this._buildFromItems(e,t,!1)},t=>{this.props.items===e.items&&(this._buildFromItems(e,[],!1),console.warn(`Failed to get items for PickList: ${t&&t.message?t.message:t}`))}),!this._itemsAnnouncer){const s=p.ProgressAnnouncer.forPromise(e.items,{announceStartMessage:t.VSSResourcesVSSUI.AnnounceLoadingItems,announceEndMessage:t.VSSResourcesVSSUI.AnnounceFinishedLoadingItems,announceErrorMessage:t.VSSResourcesVSSUI.AnnounceErrorLoadingItems});this._itemsAnnouncer=s}}else this._buildFromItems(e,e.items||[],!1)}_buildFromItems(e,t,s){const i=this._initialItemsLoaded;let o=this.state.initiallySelectedKeys,n=this.state.selectedKeys,r=this.state.selectedOperatorKey;s||i||!t.length||(e.initiallySelectedItems&&(n=o=this._getKeysFromItems(e.initiallySelectedItems,t)),this._initialItemsLoaded=!0),this._maintainsOwnState||(n=this._getKeysFromItems(e.selectedItems,t),r=e.selectedOperatorKey);const{searchResults:a,isSearchInProgress:c,itemsLoading:l}=this.state,h=this._wrapItems(t,n),d=this._wrapItems(a,n,"search-results"),p=this._groupItems(h),m=this._groupItems(d,p),u=this._filterByText(this._searchText,m),_=this._buildGroupedItems(this._searchText,c,a,u,e.groups,n,s);l&&this._searchText&&this._announceSearchResults(u,c,s),this.setState({items:t,groupDictionary:p,initiallySelectedKeys:o,filteredItems:_,selectedKeys:n,itemsLoading:s,selectedOperatorKey:r},()=>{!i&&this._initialItemsLoaded&&this._focusOnInitialLoad&&this.focus(!0)})}_announceSearchResults(e,s,i){if(!s&&!i){let s=0;for(const t in e)s+=e[t].length;p.announce(s>0?h.format(t.VSSResourcesVSSUI.AnnounceFilterResultCount,s):t.VSSResourcesVSSUI.NoFilterResults,!0,S)}}_wrapItems(e,t,s){const{getListItem:i,onSearch:o}=this.props;return e.map(e=>{const o=i?i(e):{name:e,key:e};o.groupKey||(o.groupKey="undefined-key");const n=Object.assign({},o,{isSelected:t.some(e=>e===o.key),data:e});return s&&(n.groupKey=s),this._itemDictionary[o.key]=n,n})}_groupItems(e,t){const s={};if(t)for(const e in t)s[e]=[...t[e]];return e&&e.length&&e.forEach(e=>{const t=e.groupKey;s[t]||(s[t]=[]),s[t].push(e)}),s}_filterByText(e,t){let s={};if(e){const i=this.props.onFilterItemByText||this._defaultFilterItemByText;for(const o in t){if(this._selectedPivot&&this.props.limitSearchToPivot&&"search-results"!==o){const e=this.props.groups.filter(e=>e.key===o)[0];if(!e||e.pivotId!==this._selectedPivot)continue}const n=t[o].filter(t=>t.isSeparator||i(e,t,t.data));s[o]=n}}else s=t;return s}_isExactMatch(e,t){return t.name.toLowerCase()===e.toLowerCase()}_buildGroupedItems(e,s,o,n,r,c,l){let d=[];const{itemsLoadingText:p,onSearch:m,onHasMoreSearchResults:u,searchResultsGroupName:_,searchResultsLoadingText:g,selectionMode:S,showSelectAll:I}=this.props,f=this._getCurrentPivot(),v=h.format(f&&f.searchNoResultsText||this.props.searchNoResultsText||t.VSSResourcesVSSUI.NoFilterResults,e||""),k=[{key:"undefined-key"}].concat(r||[]);m&&k.push({key:"search-results",name:_});let L=!1,y=!1;if(this._searchingContentHidden=!1,k.forEach(i=>{const r=i.key,a=n[r],c=!this._selectedPivot||this._selectedPivot===i.pivotId||this._searchText&&!this.props.limitSearchToPivot||"search-results"===i.key;this._selectedPivot&&!i.pivotId&&"search-results"!==r&&a&&a.length&&h.warn("Picklist pivots are being used and items were provided with no pivot id.  All items should be within a group with a valid pivot id"),a&&a.length&&c?((L&&"search-results"!==r||i.name)&&d.push({isSeparator:!0,isGroupHeader:!0,name:i.name,key:"group-name-"+i.key,data:void 0,isSelected:!1,onRender:i.onRenderGroupHeader?()=>i.onRenderGroupHeader(i):void 0}),d=d.concat(a),L=!0,!i.isLoading||this._searchText&&m?"search-results"===r&&u&&u(o)&&d.push({isSeparator:!0,isLoadingIndicator:!0,name:g||t.VSSResourcesVSSUI.Searching,key:"search-loading-"+i.key,data:void 0,isSelected:!1,onRender:e=>(s||this._updateSearchText(o),e)}):d.push({isSeparator:!0,isLoadingIndicator:!0,name:i.loadingMessage||p||t.VSSResourcesVSSUI.Loading,key:"items-loading-"+i.key,data:void 0,isSelected:!1,onRender:e=>(this._requestGroupLoad(i.key),e)})):"search-results"===r?e&&e.length&&m&&(s&&this._hideSearchingContent?this._searchingContentHidden=!0:(s||!s&&0===d.length)&&((L||i.name)&&d.push({isSeparator:!0,isGroupHeader:!0,name:i.name||"",key:"group-name-"+i.key,isSelected:!1}),s?d.push({isSeparator:!0,isLoadingIndicator:!0,name:g||t.VSSResourcesVSSUI.Searching,key:"search-loading-"+i.key,data:void 0,isSelected:!1}):this.state.searchError?d.push({isSeparator:!0,messageLevel:2,name:this.state.searchError.message,key:"search-error-"+i.key,data:void 0,isSelected:!1}):d.push({isSeparator:!0,messageLevel:1,name:v,key:"search-no-results-"+i.key,data:void 0,isSelected:!1}),L=!0)):(l&&"undefined-key"===i.key&&!this._selectedPivot||i.isLoading&&c&&(!this._searchText||!m))&&(y||(y=!0,(L||i.name)&&d.push({isSeparator:!0,isGroupHeader:!0,name:i.name,key:"group-name-"+i.key,data:void 0,isSelected:!1}),d.push({isSeparator:!0,isLoadingIndicator:!0,name:i.loadingMessage||p||t.VSSResourcesVSSUI.Loading,key:"items-loading-"+i.key,data:void 0,isSelected:!1,onRender:e=>(this._requestGroupLoad(i.key),e)}),L=!0))}),e&&e.length&&!s&&0===d.length&&d.push({isSeparator:!0,messageLevel:1,name:v,key:"search-no-results",data:void 0,isSelected:!1}),S===a.SelectionMode.multiple&&I&&d.length>1){const e=-1!==c.indexOf(i),s={key:i,name:t.VSSResourcesVSSUI.PickListSelectAllActionText,isSelected:!!e};d.splice(0,0,s),this._itemDictionary[i]=s}return d}_requestGroupLoad(e){if(this.props.onGroupLoadRequest&&!this._groupLoadRequested[e]&&!this.state.itemsLoading){this._groupLoadRequested[e]=!0;const t=this.state.items.length;this.props.onGroupLoadRequest(e).then(()=>{delete this._groupLoadRequested[e],this.state.items.length>t&&this.forceUpdate()})}}_getOnSearchPromise(e,t){const{onSearch:s}=this.props,i=s?s(e,this.state.items,this._selectedPivot,t):[];return Promise.resolve(i)}_onSingleSelectionChanged(e,t){return!t&&this._onSelectionChanged([e])}_onMultipleSelectionChanged(e,s,o){if(o)return!1;let n=[];return e===i?n=s?this._getKeysFromItems(this.state.items,this.state.items):[]:(n=this.state.selectedKeys.filter(e=>e!==i),s?(n.push(e),p.announce(t.VSSResourcesVSSUI.AnnouncePickListItemSelect,!0)):(n.splice(n.indexOf(e),1),p.announce(t.VSSResourcesVSSUI.AnnouncePickListItemDeselect,!0)),n.length===this.state.items.length&&(n=[i,...n])),this._onSelectionChanged(n)}_getIndicators(e,t){return t?t.map(t=>{if(e.data)return t.getItemIndicator(e.data)}):[]}_getKeysFromItems(e,t){if(e){let s=[];const{getListItem:o}=this.props;return s=o?e.map(e=>o(e).key):e,t&&s.length===t.length&&(s=[i,...s]),s}return[]}_hasNewItems(e){return this._isThenable(e.items)?e.items.then(e=>!k._arrayEquals(e,this.state.items)):Promise.resolve(!k._arrayEquals(this.state.items,e.items))}_haveGroupsChanged(e){const t=e.groups,s=this.props.groups;return!(!t&&!s)&&(!t||!s||(t.length!==s.length||t.some((e,t)=>s[t].key!==e.key||s[t].name!==e.name||s[t].isLoading!==e.isLoading)))}_isThenable(e){return e&&"function"==typeof e.then}static _arrayEquals(e,t){if(e&&t){if(e.length!==t.length)return!1;for(let s=0;s<e.length;s++)if(e[s]!==t[s])return!1;return!0}return e===t}}t.ComponentsPickListPickList.PickList=k;class L extends s.Component{constructor(){super(...arguments),this._onKeyDown=(e=>{if(13===e.which||32===e.which&&this.props.spaceBarTriggersClick){e.target===this._rowDiv&&(this.props.href?e.ctrlKey||e.shiftKey?window.open(this.props.href,"_blank","noopener"):this.props.onKeyboardEnter()||(window.location.href=this.props.href):this.props.onKeyboardEnter())}if(37===e.which){const t=e.target;t.id===h.getFirstFocusable(this._rowDiv,t,!0).id&&this._rowDiv.focus()}})}render(){return s.createElement("div",{role:"option","aria-selected":this.props.isSelected,"aria-label":this.props.ariaLabel,"aria-describedby":t.Util.getSafeId(this.props.ariaDescribedBy),"aria-setsize":this.props.setSize,"aria-posinset":this.props.itemIndex+1,className:h.css("vss-PickList--row",this.props.disabled&&"disabled",this.props.firstInGroup&&"first-in-group"),ref:e=>this._rowDiv=e,"data-is-focusable":!0,onKeyDown:this._onKeyDown,"data-selection-key":this.props.dataSelectionKey},s.createElement(n.FocusZone,{direction:n.FocusZoneDirection.horizontal},this.props.children))}}class y extends s.Component{constructor(){super(...arguments),this._onClick=(e=>{const{item:t,onSelectionChanged:s}=this.props;s&&(t.href&&(e.ctrlKey||e.shiftKey||1===e.button||2===e.button)||s()&&e.preventDefault())})}render(){const{item:e,indicators:i}=this.props,o=s.createElement("span",{className:"vss-PickList--selectableElementButton-text"},this.props.onRenderItemText?this.props.onRenderItemText(e,e.data):e.name),n=[];if(e.iconProps){let i="vss-PickList--selectableElementButtonIcon";e.iconProps.className&&(i=h.css(i,e.iconProps.className)),n.push(s.createElement(t.VssIcon.VssIcon,Object.assign({key:"icon"},e.iconProps,{className:i})))}else e.onRenderIcon&&n.push(s.createElement("span",{key:"icon",className:"vss-PickList--selectableElementButtonIcon"},e.onRenderIcon()));n.push(s.createElement(t.TooltipEx.Tooltip,{key:"text-container",overflowOnly:!e.tooltipText||e.tooltipText===e.name,text:e.tooltipText||e.name},s.createElement("div",{className:"vss-PickList--selectableElementButton-textContainer"},o)));const r="function"==typeof e.disabled?e.disabled():e.disabled;return s.createElement("div",{className:h.css("vss-PickList--element","vss-PickList--selectableElement",{"is-selected":e.isSelected,disabled:r})},e.href?s.createElement("a",{className:"vss-PickList--selectableElementButton",tabIndex:-1,"data-is-focusable":!1,href:e.href,onClick:this._onClick},n):s.createElement("div",{className:"vss-PickList--selectableElementButton",role:"button",onClick:this._onClick,tabIndex:-1,"data-is-focusable":!1},n),s.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:i,onClick:this._onClick}))}}class P extends s.Component{constructor(){super(...arguments),this._onClick=(e=>{e.defaultPrevented||(this.props.onSelectionChanged(!this.props.item.isSelected),e.preventDefault())})}render(){const{item:e,indicators:i}=this.props,o=e.iconProps?s.createElement(t.VssIcon.VssIcon,Object.assign({className:"vss-PickList--multiSelectIcon"},e.iconProps)):e.onRenderIcon?s.createElement("span",{className:"vss-PickList--multiSelectIcon"},e.onRenderIcon()):null,n="function"==typeof e.disabled?e.disabled():e.disabled,r=s.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:e.name},s.createElement("div",{className:"vss-PickList--multiSelectTextContainer"},s.createElement("span",{className:h.css("vss-PickList--multiSelectText",n&&"disabled")},e.name))),a=s.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:i});return s.createElement("div",{className:h.css("vss-PickList--element","vss-PickList--multiSelectableElement"),onClick:this._onClick},s.createElement(t.Checkbox.Checkbox,{className:"vss-PickList--checkbox",checked:e.isSelected,disabled:n,ariaLabel:e.name}),o,r,a)}}class x extends s.Component{constructor(){super(...arguments),this._onClick=(e=>{const{action:t}=this.props;t.onClick&&t.onClick(e)}),this._onKeyDown=(e=>{if(!this.props.action.disabled&&(13===e.which||32===e.which)){const{action:t}=this.props,s=e.ctrlKey||e.shiftKey;!t.onClick||t.href&&s?t.href&&(s?window.open(t.href,"_blank","noopener"):window.location.href=t.href):this.props.action.onClick(e)}})}render(){const{setSize:e,itemIndex:i}=this.props,{href:o,iconProps:n,name:r,disabled:a,ariaLabel:c,tooltipText:l}=this.props.action;let h=s.createElement(t.Button.Button,{subtle:!0,className:"vss-PickList--selectableElementButton",onClick:this._onClick,disabled:a,href:o,excludeTabStop:!0,excludeFocusZone:!0,iconProps:n?t.VssIcon.VssIcon.getIconProps(n,"vss-PickList--selectableElementButtonIcon"):void 0,tooltipProps:l?{showOnFocus:!0,text:l}:void 0},r);return l&&(h=s.createElement(t.TooltipEx.Tooltip,{text:l},s.createElement("span",{className:"vss-PickList--action-tooltip"},h))),s.createElement("div",{"aria-label":void 0!==c?c:r,"aria-posinset":i+1,"aria-setsize":e,className:"vss-PickList--action","data-is-focusable":!0,role:"option",onKeyDown:this._onKeyDown},h)}}class C extends s.Component{constructor(){super(...arguments),this._radioButton=s.createRef(),this._onSelect=(e=>{this.props.onChange(e)})}render(){const{operators:e,selectedOperatorKey:i}=this.props,o=e.map((e,i)=>{const o=0===i?this._radioButton:void 0;return s.createElement(t.RadioButton.RadioButton,{text:e.name,id:e.key,ref:o,key:e.key})});return s.createElement(t.RadioButton.RadioButtonGroup,{selectedButtonId:i,onSelect:this._onSelect,excludeFocusZone:!0,direction:1},o)}focus(){this._radioButton.current&&this._radioButton.current.focus()}}class b extends s.PureComponent{constructor(){super(...arguments),this.state={isVisible:!1}}componentDidMount(){this.timeoutId=window.setTimeout(()=>{this.setState({isVisible:!0}),this.timeoutId=-1},u)}componentWillUnmount(){window.clearTimeout(this.timeoutId)}render(){return this.state.isVisible?s.createElement(t.Spinner.Spinner,Object.assign({},this.props)):null}}}(),function(e){f=t.ComponentsPickListPickListDropdown={},Object.defineProperty(t,"__esModule",{value:!0});const i=200,o=50;t.ComponentsPickListPickListDropdown.PickListDropdown=class extends h.BaseComponent{constructor(e){super(e),this._onBlur=(()=>{this._getEffectiveIsListOpen()||this.props.onFocusLost&&this.props.onFocusLost()}),this._onClick=(()=>{this.props.disabled||this._togglePickList(!this._getEffectiveIsListOpen())}),this._onKeyDown=(e=>{this.props.disabled||(13===e.which||40===e.which?(this._togglePickList(!this._getEffectiveIsListOpen()),e.preventDefault()):27===e.which&&(this._togglePickList(!1),this._dropdownTitle.focus()))}),this._onPickListFocusLost=(()=>{this._shouldRefocus=!0,this._togglePickList(!1)}),this._onPositioned=(()=>{this._shouldRefocus&&(this._shouldRefocus=!1,this._pickList&&this._pickList.focus())}),this._onDismiss=(e=>{this._shouldRefocus=!0,this._togglePickList(!1),27===e.which&&this._dropdownTitle.focus()}),this._onSelectionChanged=(e=>{const t=this._getEffectiveIsListOpen()&&this.props.selectionMode===a.SelectionMode.multiple;if(this._togglePickList(t),this._maintainsOwnState&&this.setState({selectedItems:e.selectedItems}),this.props.onSelectionChanged)return this.props.onSelectionChanged(e)}),this._getNameFromItem=(e=>this.props.getListItem?this.props.getListItem(e).name:e),this._getIconFromItem=(e=>{if(this.props.getListItem)return this.props.getListItem(e).iconProps}),this._id=d.getId("PickListDropdown"),this._maintainsOwnState=!1,e.initiallySelectedItems&&e.selectedItems&&console.warn("Please only provide ONE of initiallySelectedItems OR selectedItems as props"),e.initiallySelectedItems&&(this._maintainsOwnState=!0),this.state={isListOpen:!1,pickListWidth:e.pickListWidth||e.width||i,selectedItems:this._maintainsOwnState?e.initiallySelectedItems:void 0},this._shouldRefocus=!0}focus(){this._getEffectiveIsListOpen()?this._pickList.focus():this._dropdownTitle.focus()}forceUpdate(){this._pickList&&this._pickList.forceUpdate()}render(){const{className:e,pickListClassName:i,placeholder:n,getPickListItems:r,disabled:c,selectionMode:l,preventDismissOnScroll:h=!0,tabIndex:p,hideSelectedItemIcon:_,dropdownIconProps:g={iconType:0,iconName:"ChevronDown"},directionalHint:S,onRenderSelectedItemText:f,id:v,onFocus:k,excludeFocusZone:L}=this.props,y=this._maintainsOwnState?this.state.selectedItems:this.props.selectedItems,P=this._getEffectiveIsListOpen(),x=y&&y.length>0,C=x?this._getTitleText(y):n,b=t.Util.css("vss-PickListDropdown",e),w=t.Util.css("vss-PickListDropdown--list",i);let E;this.props.showPlaceholderAsLabel&&n&&x&&(E=s.createElement("span",{className:"vss-PickListDropdown--title-text vss-PickListDropdown--placeholder-label"},`${n}: `));let T=E?`${n}: ${C}`:C;this.props.ariaLabelFormat&&(T=u.format(this.props.ariaLabelFormat,x?C:"")),P&&(this._shouldRefocus=!0);let R=void 0;x&&!_&&(R=l===a.SelectionMode.multiple?{iconType:0,iconName:"CheckMark",className:"vss-PickListDropdown--title-checkIcon"}:this._getIconFromItem(y[0]));const O=v||d.getId("PickList"),F={};return this.props.width&&(F.width=this.props.width+"px"),s.createElement("div",{className:b,ref:this._resolveRef("_dropdown"),style:F},s.createElement(t.FocusZone.FocusZoneContext.Consumer,null,e=>s.createElement("div",{tabIndex:c?-1:p||0,ref:e=>this._dropdownTitle=e,onClick:this._onClick,onKeyDown:this._onKeyDown,className:t.Util.css("vss-PickListDropdown--title",!x&&"vss-PickListDropdown--placeholder",c&&"disabled",P&&"focused"),"aria-expanded":P,"aria-label":T,"aria-describedby":t.Util.getSafeId(this.props.ariaDescribedBy),"aria-disabled":!!c,"data-focuszone":!c&&!L&&e.focuszoneId,role:"button",id:t.Util.getSafeId(this._id),"aria-owns":P?t.Util.getSafeId(O):null,onFocus:k,onBlur:this._onBlur},R&&s.createElement(t.VssIcon.VssIcon,Object.assign({},R)),s.createElement(t.TooltipEx.Tooltip,{overflowOnly:!0,text:C},s.createElement("div",{className:"vss-PickListDropdown--title-textContainer"},E,s.createElement("span",{className:t.Util.css("vss-PickListDropdown--title-text",x&&"vss-PickListDropdown--title-text-withSelections"),role:"textbox","aria-readonly":!0},f?f(y):s.createElement(s.Fragment,null,C)))),s.createElement(t.VssIcon.VssIcon,Object.assign({},g,{className:t.Util.css(g.className,"vss-PickListDropdown--title-caretIcon")})),this.getIndicators(y))),P&&s.createElement(m.Callout,{className:"vss-PickListDropdown--callout",onDismiss:this._onDismiss,onPositioned:this._onPositioned,target:this._dropdown,isBeakVisible:!1,preventDismissOnScroll:h,gapSpace:0,directionalHint:void 0!==S?S:4},s.createElement(I.PickList,Object.assign({},this.props,{initiallySelectedItems:void 0,selectedItems:y,width:this.state.pickListWidth,className:w,onSelectionChanged:this._onSelectionChanged,ref:e=>this._pickList=e,items:r(),onGroupLoadRequest:this.props.onGroupLoadRequest,onFocusLost:this._onPickListFocusLost,id:O,shouldVirtualize:e=>(e||[]).length>o}))))}componentDidMount(){this.props.autoFocus&&this.focus()}_getTitleText(e){let t=this._getNameFromItem(e[0]);return e.length>1&&(t=`${t} (+${e.length-1})`),t}getIndicators(e){const{selectedItemIndicators:i}=this.props;return e&&e.length&&i&&i.length?s.createElement(t.ItemIndicator.ItemIndicatorSet,{indicators:i.map(t=>t.getItemIndicator(e[0]))}):null}_togglePickList(e){let t=this.props.pickListWidth||this.props.width||(this._dropdownTitle?this._dropdownTitle.clientWidth:i);this.setState({isListOpen:e,pickListWidth:t},()=>this.props.onToggleDropdown&&this.props.onToggleDropdown(this.state.isListOpen))}_getEffectiveIsListOpen(){return void 0!==this.props.isOpen?this.props.isOpen:this.state.isListOpen}}}(),function(e){v=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),t[e].PICKER_CHANGE_EVENT="picker-changed";class i extends h.BaseComponent{constructor(e){super(e),this.updateDelegate=(()=>this.forceUpdate()),this.state={}}componentDidMount(){this._events.on(this.props.provider,t[e].PICKER_CHANGE_EVENT,this.updateDelegate)}componentWillUnmount(){this._events.off(this.props.provider,t[e].PICKER_CHANGE_EVENT,this.updateDelegate)}componentWillReceiveProps(s){this.props.provider!==s.provider&&(this._events.off(this.props.provider,t[e].PICKER_CHANGE_EVENT,this.updateDelegate),this._events.on(s.provider,t[e].PICKER_CHANGE_EVENT,this.updateDelegate))}}t[e].ItemPickerComponentBase=i;t[e].ItemPickerDropdown=class extends i{render(){const{className:e,provider:i,minWidth:o,pickListWidth:n,pickListClassName:r,tabIndex:a,placeholderText:c,hideSelectedItemIcon:l,dropdownIconProps:h,autoFocus:d,onFocus:p,onFocusLost:m}=this.props;return s.createElement(f.PickListDropdown,{id:this.props.id,componentRef:e=>this.pickListDropdown=e,className:t.Util.css("item-picker-dropdown",e),getListItem:i.getListItem,getPickListItems:()=>i.getItems(),onSelectionChanged:e=>!!i.onSelectedItemChanged&&i.onSelectedItemChanged(e&&e.selectedItems?e.selectedItems[0]:void 0),selectedItems:i.selectedItem?[i.selectedItem]:void 0,indicators:i.dropdownIndicators,pickListClassName:r,selectedItemIndicators:i.selectedItemIndicators,pivots:i.pivots,groups:i.groups,limitSearchToPivot:i.limitSearchToPivot,onGroupLoadRequest:i.onGroupLoadRequest,placeholder:c,isSearchable:i.isSearchable,minItemsForSearchBox:i.minItemsForSearchBox,searchTextPlaceholder:i.searchTextPlaceholder,searchResultsGroupName:i.searchResultsGroupName,searchResultsLoadingText:i.searchResultsLoadingText,searchNoResultsText:i.searchNoResultsText,onSearch:i.onSearch,onHasMoreSearchResults:i.onHasMoreSearchResults,onFilterItemByText:i.onFilterItemByText,getActions:e=>i.actions,noItemsText:i.noItemsText,selectExactMatchOnEnter:i.selectExactMatchOnEnter,width:o,pickListWidth:n,tabIndex:a,hideSelectedItemIcon:l,dropdownIconProps:h,autoFocus:d,shouldVirtualize:e=>(e||[]).length>50,onRenderItemText:this.props.onRenderItemText,isOpen:this.props.isOpen,onToggleDropdown:this.props.onToggleDropdown,ariaDescribedBy:this.props.ariaDescribedBy,onFocus:p,onFocusLost:m})}focus(){this.pickListDropdown&&this.pickListDropdown.focus()}};t[e].ItemPickList=class extends i{render(){const{className:e,provider:i,useDropdownStyle:o,shouldVirtualize:n}=this.props;return s.createElement(I.PickList,{componentRef:e=>this.pickList=e,className:t.Util.css(o?"item-picker-dropdown":"item-picker-list",e),getListItem:i.getListItem,items:i.getItems(),onSelectionChanged:e=>!!i.onSelectedItemChanged&&i.onSelectedItemChanged(e&&e.selectedItems?e.selectedItems[0]:void 0),selectedItems:i.selectedItem?[i.selectedItem]:void 0,indicators:i.dropdownIndicators,groups:i.groups,pivots:i.pivots,limitSearchToPivot:i.limitSearchToPivot,onGroupLoadRequest:i.onGroupLoadRequest,isSearchable:i.isSearchable,searchTextPlaceholder:i.searchTextPlaceholder,searchResultsGroupName:i.searchResultsGroupName,searchResultsLoadingText:i.searchResultsLoadingText,searchNoResultsText:i.searchNoResultsText,onSearch:i.onSearch,onHasMoreSearchResults:i.onHasMoreSearchResults,onFilterItemByText:i.onFilterItemByText,getActions:e=>i.actions,noItemsText:i.noItemsText,selectExactMatchOnEnter:i.selectExactMatchOnEnter,shouldVirtualize:n||(e=>(e||[]).length>50),minItemsForSearchBox:o?void 0:1,onRenderItemText:this.props.onRenderItemText})}}}("ComponentsPickListItemPicker"),function(e){k=t.ComponentsPickListPickListFilterBarItem={},Object.defineProperty(t,"__esModule",{value:!0});const i=256;t.ComponentsPickListPickListFilterBarItem.PickListFilterBarItem=class extends t.FilterBarItem.FilterBarItem{constructor(e){super(e),this._onClearClicked=(()=>{this.setFilterValue({value:[],operator:this.state.operator}),this.focus(),p.announce(t.VSSResourcesVSSUI.AnnounceFilterCleared)}),this._onSelectionChanged=(e=>{let t=!1;return this.props.onSelectionChanged&&(t=this.props.onSelectionChanged(e)),this.setFilterValue({value:e.selectedItems,operator:e.selectedOperatorKey}),t}),this.onRenderFooter=(()=>{const{hideClearButton:e,selectionMode:i}=this.props;if(!0!==e&&(void 0!==e||i!==a.SelectionMode.single))return s.createElement("div",{className:"vss-PickList--filterBarFooter flex-column"},s.createElement(t.Button.Button,{className:"flex-self-end vss-PickList--filterBarFooterClear",iconProps:{iconName:"Clear"},subtle:!0,disabled:!this.state.value||0===this.state.value.length,ariaLabel:t.VSSResourcesVSSUI.PickListClearActionAriaLabel,onClick:this._onClearClicked},t.VSSResourcesVSSUI.PickListClearActionText))}),this._validateProps(e)}componentWillReceiveProps(e){super.componentWillReceiveProps(e),this._validateProps(e)}focus(){this._pickListDropdown.focus()}forceUpdate(){this._pickListDropdown&&this._pickListDropdown.forceUpdate()}render(){const{placeholder:e,className:o,pickListClassName:n}=this.props,{value:r}=this.state;var c=null,l=this.props.operators;const d=h.css("vss-PickListDropdown--filterBar",o),p=h.css("vss-PickList--filterBar",n);return this.props.showOrAndOperators&&(l=[{name:t.VSSResourcesVSSUI.FilterOperatorOr,key:"or"},{name:t.VSSResourcesVSSUI.FilterOperatorAnd,key:"and"}]),e&&(c=r&&r.length>0?u.format(t.VSSResourcesVSSUI.FilterDropdownLabel,e)+" {0}":u.format(t.VSSResourcesVSSUI.FilterDropdownLabelNoSelection,e)),s.createElement(f.PickListDropdown,Object.assign({className:d,pickListClassName:p,componentRef:e=>this._pickListDropdown=e,showSelectAll:this.props.selectionMode===a.SelectionMode.multiple,ariaLabelFormat:c},this.props,{operators:l,selectedItems:r,selectedOperatorKey:this.state.operator,onSelectionChanged:this._onSelectionChanged,pickListWidth:i,directionalHint:6,width:void 0,onRenderFooter:this.onRenderFooter}))}_validateProps(e){}}}(),function(e){function s(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}L=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),s(v),s(I),s(f),s(k)}("ComponentsPickListindex"),function(e){y=t[e]={},Object.defineProperty(t,"__esModule",{value:!0}),function(s){for(var i in s)t[e].hasOwnProperty(i)||(t[e][i]=s[i])}(L)}("PickList"),t.RegistrationVssComponentPicklistRegistration={},Object.defineProperty(t,"__esModule",{value:!0}),_.VssComponent.register("picklist",y.PickList)},["Components/ComboBox/ComboBox","Components/ComboBox/index","ComboBox","Components/PickList/PickList","Components/PickList/PickListDropdown","Components/PickList/ItemPicker","Components/PickList/PickListFilterBarItem","Components/PickList/index","PickList","Registration/VssComponentPicklistRegistration"]),document.dispatchEvent(new CustomEvent("scriptLoaded",{cancelable:!1,detail:{id:"ms.vss-features.ui-picklist-content"}}));